/// <reference path="node_modules/@types/jquery/index.d.ts" />
/// <reference path="node_modules/@types/lodash/index.d.ts" />
var DEBUG = true;
var Log = (function () {
    function Log() {
    }
    Log.out = function (msg) {
        $("<pre/>").text(msg + "\n").appendTo("#log");
    };
    Log.html = function (html) {
        $("<div/>").html(html).appendTo("#log");
    };
    return Log;
}());
var PuzzleDemo = (function () {
    function PuzzleDemo(solution) {
        this.solution = [];
        this.solution = solution;
        Log.out("Puzzle:\n   " + solution.join(" "));
    }
    PuzzleDemo.random = function (length) {
        return new PuzzleDemo(_.shuffle(_.map(new Array(length), function (v, k) { return k + 1; })));
    };
    PuzzleDemo.prototype.getPieceCount = function () {
        return this.solution.length;
    };
    PuzzleDemo.prototype.test = function (board) {
        var count = 0;
        for (var i = 0, len = this.solution.length; i < len; i++) {
            var correct = board.pieces[i].quantity == this.solution[i];
            if (correct)
                count++;
            if (DEBUG)
                board.debugViewCorrectPieces[i] = correct;
        }
        return count;
    };
    return PuzzleDemo;
}());
var HumanPuzzleInterface = (function () {
    function HumanPuzzleInterface(pieceCount) {
        this.lastSequence = [];
        this.pieceCount = pieceCount;
    }
    HumanPuzzleInterface.prototype.getPieceCount = function () {
        return this.pieceCount;
    };
    HumanPuzzleInterface.prototype.test = function (board) {
        var _this = this;
        var answer;
        do {
            var n = _.map(board.pieces, function (s) { return s.quantity; });
            var display = _.map(n, function (d, i) { return _this.lastSequence.length > 0 && d == _this.lastSequence[i] ? d : "(" + d + ")"; });
            this.lastSequence = n;
            answer = parseInt(prompt("Please input the following sequence:\n\n    " + display.join("  ") + "\n\nAfter each player clicks their blue button\nhow many yellow lights are lit?"), 10);
        } while (isNaN(answer));
        return answer;
    };
    return HumanPuzzleInterface;
}());
var UNKNOWN = "U";
var MAYBE_NO = "MN";
var NO = "N";
var MAYBE_YES = "MY";
var YES = "Y";
var Swap = (function () {
    function Swap(a, b) {
        this.a = a;
        this.b = b;
    }
    return Swap;
}());
var Move = (function () {
    // new move based on copy of given move
    function Move(base, board, swap) {
        this.base = base;
        this.board = _.cloneDeep(board);
        if (null != swap) {
            var tmp = this.board.pieces[swap.a];
            this.board.pieces[swap.a] = this.board.pieces[swap.b];
            this.board.pieces[swap.b] = tmp;
            this.board.pieces[swap.a].index = swap.a;
            this.board.pieces[swap.b].index = swap.b;
            this.swap = swap;
        }
    }
    Move.prototype.render = function () {
        var s = this.num + ": ";
        for (var i = 0, len = this.board.pieces.length; i < len; i++) {
            var piece = this.board.pieces[i];
            var underline = (null != this.swap && (piece.quantity == this.board.pieces[this.swap.a].quantity || piece.quantity == this.board.pieces[this.swap.b].quantity));
            var bold = this.board.debugViewCorrectPieces[i];
            s += "" + (bold ? "<b>" : "") + (underline ? "(" : "") + piece.quantity + (underline ? ")" : "") + (bold ? "</b>" : "") + " ";
        }
        s += (this.num === 1 ? "FIRST" :
            " = " + this.correct + " (" + (this.delta < 0 ? this.delta : "+" + this.delta) + ") score: " + this.score());
        Log.html(s);
    };
    Move.prototype.score = function () {
        return this.correct + (this.delta * .5);
    };
    Move.prototype.getSwapA = function () {
        return this.board.pieces[this.swap.a];
    };
    Move.prototype.getSwapB = function () {
        return this.board.pieces[this.swap.b];
    };
    Move.prototype.getSwapInBase = function (k) {
        var _this = this;
        return _.find(this.base.board.pieces, function (s) {
            return s.quantity === _this.board.pieces[_this.swap[k]].quantity;
        });
    };
    Move.prototype.hasSwapDeduction = function (a, b) {
        return this.getSwapA().deduction == a &&
            this.getSwapB().deduction == b;
    };
    // TODO: find the adjacent pair in given two moves
    // adj pair in two moves =
    // if move1 = a,b and move2 = b,c then ajc pair = a
    Move.copyMostValuableMove = function (history) {
        var mostValuable;
        for (var i = 0, len = history.length; i < len; i++) {
            var current = history[i];
            if (null == mostValuable || mostValuable.score() < current.score()) {
                mostValuable = current;
            }
        }
        return mostValuable.clone();
    };
    Move.prototype.clone = function () {
        var move = new Move(this, this.board);
        move.num = this.num;
        move.correct = this.correct;
        move.delta = this.delta;
        return move;
    };
    Move.rejectWasteMove = function (history, candidate) {
        for (var i = 0, len = history.length; i < len; i++) {
            var current = history[i];
            // reject if this board has been played before
            if (Board.compare(current.board, candidate.board)) {
                if (DEBUG)
                    Log.out("Rejecting board played before at move " + current.num + " " + candidate.board.pieces.join(" "));
                return true;
            }
        }
        for (var i = 0, len = history.length; i < len; i++) {
            var current = history[i];
            for (var i_1 = 0, len_1 = current.board.pieces.length; i_1 < len_1; i_1++) {
                var cur = current.board.pieces[i_1];
                var can = candidate.board.pieces[i_1];
                // reject if history contains a YES that isn't included here
                if (YES === cur.deduction && can.quantity !== cur.quantity) {
                    if (DEBUG)
                        Log.out("Rejecting index " + can.quantity + can.deduction.substr(0, 2) + "@" + can.index + " which was " + cur.quantity + cur.deduction.substr(0, 2) + "@" + cur.index + " before at move " + current.num);
                    return true;
                }
                // reject if history contains a NO that is included again here
                if (NO === cur.deduction && can.quantity === cur.quantity) {
                    if (DEBUG)
                        Log.out("Rejecting index " + can.quantity + can.deduction.substr(0, 2) + "@" + can.index + " which was " + cur.quantity + cur.deduction.substr(0, 2) + "@" + cur.index + " before at move " + current.num);
                    return true;
                }
            }
        }
        return false;
    };
    Move.crossJoinCandidates = function (candidates) {
        var result = [];
        for (var x = 0, xlen = candidates.length; x < xlen; x++) {
            for (var y = 0, ylen = candidates.length; y < ylen; y++) {
                if (x != y)
                    result.push(candidates[x], candidates[y]);
            }
        }
        return result;
    };
    return Move;
}());
var Piece = (function () {
    function Piece() {
    }
    Piece.prototype.setDeduction = function (deduction, board, index) {
        if (YES === this.deduction || NO === this.deduction)
            return; // hard conclusions to change
        if (DEBUG) {
            Log.out("    " + this.quantity + this.deduction.substr(0, 2) + "@" + this.index + " => " + deduction.substr(0, 2) + (deduction == YES ? " FOUND" : ""));
            if (YES === deduction && !board.debugViewCorrectPieces[index]) {
                Log.out("      but its wrong");
                debugger;
            }
        }
        this.deduction = deduction;
    };
    Piece.prototype.toString = function () {
        return "" + this.quantity + this.deduction.substr(0, 2) + "@" + this.index;
    };
    return Piece;
}());
var Board = (function () {
    function Board(pieces) {
        this.debugViewCorrectPieces = [];
        this.pieces = pieces;
    }
    Board.prototype.findAll = function (fn) {
        return _.filter(this.pieces, fn);
    };
    Board.prototype.findOne = function (fn) {
        return this.findAll(fn)[0];
    };
    Board.compare = function (a, b) {
        if (a.pieces.length != b.pieces.length)
            return false;
        for (var i = 0, len = a.pieces.length; i < len; i++) {
            if (a.pieces[i].quantity != b.pieces[i].quantity) {
                return false;
            }
        }
        return true;
    };
    Board.prototype.render = function () {
        for (var i = 0, len = this.pieces.length; i < len; i++) {
            $("td#c" + i).text(this.pieces[i].quantity + " " + this.pieces[i].deduction.substr(0, 2));
        }
    };
    Board.prototype.toString = function () {
        return this.pieces.join(" ");
    };
    return Board;
}());
var Solver = (function () {
    function Solver(puzzle) {
        var _this = this;
        this.moves = 0;
        this.puzzle = puzzle;
        // begin with opening move
        this.rootMove = new Move(null, new Board(_.map(new Array(this.puzzle.getPieceCount()), function (nil, i) {
            var piece = new Piece();
            piece.index = i;
            piece.quantity = i + 1;
            piece.deduction = UNKNOWN;
            return piece;
        })));
        _.map(this.rootMove.board.pieces, function (piece) { return _this.unknown.push(piece); });
        this.playMove(this.rootMove);
    }
    Solver.prototype.getHistory = function () {
        var current = this.lastMove;
        var history = [];
        while (null != current) {
            history.push(current);
            current = current.prev;
        }
        return history;
    };
    Solver.prototype.playMove = function (move) {
        // sequence move into play
        move.num = ++this.moves;
        move.prev = this.lastMove;
        this.lastMove = move;
        // test and score the move
        move.correct = this.puzzle.test(move.board);
        move.delta = move.correct - (null != move.base ? move.base.correct || 0 : 0);
        if (this.moves > MAX_GUESSES) {
            Log.out("Too many guesses; we lose.");
            return;
        }
        // update user view
        move.board.render();
        move.render();
        if (move.correct >= this.puzzle.getPieceCount()) {
            Log.out("You win in " + this.moves + " moves.");
            return;
        }
        if (null != move.swap) {
            // apply swap deductions
            if (move.delta == 0) {
                // no difference; both must be NO
                move.getSwapA().setDeduction(NO, move.board, move.swap.a);
                move.getSwapB().setDeduction(NO, move.board, move.swap.b);
                move.getSwapInBase("a").setDeduction(NO, move.base.board, move.swap.a);
                move.getSwapInBase("b").setDeduction(NO, move.base.board, move.swap.b);
            }
            else if (move.delta == 1) {
                // difference; one is now right, but we don't know which
                move.getSwapA().setDeduction(MAYBE_YES, move.board, move.swap.a);
                move.getSwapB().setDeduction(MAYBE_YES, move.board, move.swap.b);
                //move.getSwapInBase("a").setDeduction(MAYBE_NO, move.base.board, move.swap.a);
                //move.getSwapInBase("b").setDeduction(MAYBE_NO, move.base.board, move.swap.b);
            }
            else if (move.delta == 2) {
                // very positive difference; both are now right for sure
                move.getSwapA().setDeduction(YES, move.board, move.swap.a);
                move.getSwapB().setDeduction(YES, move.board, move.swap.b);
                move.getSwapInBase("a").setDeduction(NO, move.base.board, move.swap.a);
                move.getSwapInBase("b").setDeduction(NO, move.base.board, move.swap.b);
            }
            else if (move.delta == -1) {
                // difference; one was right, but we don't know which
                //move.getSwapA().setDeduction(MAYBE, move.board, move.swap.a);
                //move.getSwapB().setDeduction(MAYBE, move.board, move.swap.b);
                move.getSwapInBase("a").setDeduction(MAYBE_YES, move.base.board, move.swap.a);
                move.getSwapInBase("b").setDeduction(MAYBE_YES, move.base.board, move.swap.b);
            }
            else if (move.delta == -2) {
                // TODO: affect score of previous moves to re-evaluate highest score on next move
                // since we learn things about prior moves all the time
                // difference; both were right for sure
                move.getSwapA().setDeduction(NO, move.board, move.swap.a);
                move.getSwapB().setDeduction(NO, move.board, move.swap.b);
                move.getSwapInBase("a").setDeduction(YES, move.base.board, move.swap.a);
                move.getSwapInBase("b").setDeduction(YES, move.base.board, move.swap.b);
            }
        }
        this.decide();
    };
    Solver.prototype.decide = function () {
        var _this = this;
        // decide what to do next
        var nextMove;
        var candidates;
        var u, x;
        if (1 === this.moves) {
            // just play a swap of the first two positions
            nextMove = new Move(this.lastMove, this.lastMove.board, new Swap(0, 1));
        }
        else {
            var move = Move.copyMostValuableMove(this.getHistory());
            // try a unique new swap from non-yes deductions
            var tries = 0;
            var _loop_1 = function () {
                var rank = { MAYBE_YES: 1, NO: 2, UNKNOWN: 3, MAYBE_NO: 4 };
                if (null == candidates) {
                    candidates = _.filter(move.board.pieces, function (s) {
                        return _.includes([UNKNOWN, MAYBE_NO, MAYBE_YES, NO], s.deduction);
                    });
                    candidates = _.sortBy(candidates, function (s) { return rank[s.deduction]; });
                    candidates = Move.crossJoinCandidates(candidates);
                }
                else {
                    Log.out("repeated while: " + x + ", " + u);
                }
                Log.out(_.map(candidates, function (s) { return "" + s.quantity + s.deduction.substr(0, 2) + "@" + s.index; }).join(" "));
                var a = candidates.shift().index, b = candidates.shift().index;
                nextMove = new Move(move, move.board, new Swap(a, b));
            };
            do {
                _loop_1();
            } while ((x = Move.rejectWasteMove(this.getHistory(), nextMove))
                && (u = tries++) < LOOP_BREAKER);
            if (DEBUG && tries > LOOP_BREAKER)
                Log.out("candidates not original enough; exhausting retries");
            Log.out("escaped while: " + x + ", " + u);
        }
        if (null == nextMove) {
            Log.out("Unable to find next move.");
            return;
        }
        setTimeout(function () { return _this.playMove(nextMove); }, GUESS_DELAY);
    };
    return Solver;
}());
var LOOP_BREAKER = 999;
var GUESS_DELAY = 50; // ms
var MAX_GUESSES = 13;
var SLOT_COUNT = 6;
var puzzle;
if (DEBUG) {
    //puzzle = PuzzleDemo.random(SLOT_COUNT);
    puzzle = new PuzzleDemo([1, 6, 3, 5, 4, 2]);
    //puzzle = new PuzzleDemo([2, 3, 4, 1, 6, 5]);
    //puzzle = new PuzzleDemo([2, 4, 6, 1, 5, 3]);
    //puzzle = new PuzzleDemo([2, 1, 5, 6, 3, 4]);
    // TODO: try a puzzle where numbers can repeat
}
else {
    puzzle = new HumanPuzzleInterface(SLOT_COUNT);
}
new Solver(puzzle);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWV0aGV1cy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIm1ldGhldXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsOERBQThEO0FBQzlELDhEQUE4RDtBQUU5RCxJQUFNLEtBQUssR0FBRyxJQUFJLENBQUM7QUFFbkI7SUFBQTtJQU9BLENBQUM7SUFOYyxPQUFHLEdBQWpCLFVBQWtCLEdBQVc7UUFDNUIsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksQ0FBSSxHQUFHLE9BQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUMvQyxDQUFDO0lBQ2EsUUFBSSxHQUFsQixVQUFtQixJQUFZO1FBQzlCLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ3pDLENBQUM7SUFDRixVQUFDO0FBQUQsQ0FBQyxBQVBELElBT0M7QUFPRDtJQUdDLG9CQUFtQixRQUFrQjtRQUY3QixhQUFRLEdBQWEsRUFBRSxDQUFDO1FBRy9CLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDO1FBQ3pCLEdBQUcsQ0FBQyxHQUFHLENBQUMsaUJBQWUsUUFBUSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUcsQ0FBQyxDQUFDO0lBQzlDLENBQUM7SUFFYSxpQkFBTSxHQUFwQixVQUFxQixNQUFjO1FBQ2xDLE1BQU0sQ0FBQyxJQUFJLFVBQVUsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQ3BDLElBQUksS0FBSyxDQUFDLE1BQU0sQ0FBQyxFQUFFLFVBQVUsQ0FBQyxFQUFFLENBQUMsSUFBSSxNQUFNLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUMxRCxDQUFDO0lBRU0sa0NBQWEsR0FBcEI7UUFDQyxNQUFNLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENB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QztZQUNqRyxHQUFHLENBQUMsR0FBRyxDQUFDLG9CQUFrQixDQUFDLFVBQUssQ0FBRyxDQUFDLENBQUM7UUFDdEMsQ0FBQztRQUNELEVBQUUsQ0FBQyxDQUFDLElBQUksSUFBSSxRQUFRLENBQUMsQ0FBQyxDQUFDO1lBQ3RCLEdBQUcsQ0FBQyxHQUFHLENBQUMsMkJBQTJCLENBQUMsQ0FBQztZQUNyQyxNQUFNLENBQUM7UUFDUixDQUFDO1FBRUQsVUFBVSxDQUFDLGNBQU0sT0FBQSxLQUFJLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxFQUF2QixDQUF1QixFQUFFLFdBQVcsQ0FBQyxDQUFDO0lBQ3hELENBQUM7SUFDRixhQUFDO0FBQUQsQ0FBQyxBQWhKRCxJQWdKQztBQUVELElBQU0sWUFBWSxHQUFHLEdBQUcsQ0FBQztBQUN6QixJQUFNLFdBQVcsR0FBRyxFQUFFLENBQUMsQ0FBQyxLQUFLO0FBQzdCLElBQU0sV0FBVyxHQUFHLEVBQUUsQ0FBQztBQUN2QixJQUFNLFVBQVUsR0FBRyxDQUFDLENBQUM7QUFFckIsSUFBSSxNQUFNLENBQUM7QUFDWCxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO0lBQ1gseUNBQXlDO0lBQ3pDLE1BQU0sR0FBRyxJQUFJLFVBQVUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUM1Qyw4Q0FBOEM7SUFDOUMsOENBQThDO0lBQzlDLDhDQUE4QztJQUM5Qyw4Q0FBOEM7QUFDL0MsQ0FBQztBQUNELElBQUksQ0FBQyxDQUFDO0lBQ0wsTUFBTSxHQUFHLElBQUksb0JBQW9CLENBQUMsVUFBVSxDQUFDLENBQUM7QUFDL0MsQ0FBQztBQUNELElBQUksTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIm5vZGVfbW9kdWxlcy9AdHlwZXMvanF1ZXJ5L2luZGV4LmQudHNcIiAvPlxyXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwibm9kZV9tb2R1bGVzL0B0eXBlcy9sb2Rhc2gvaW5kZXguZC50c1wiIC8+XHJcblxyXG5jb25zdCBERUJVRyA9IHRydWU7XHJcblxyXG5jbGFzcyBMb2cge1xyXG5cdHB1YmxpYyBzdGF0aWMgb3V0KG1zZzogc3RyaW5nKSB7XHJcblx0XHQkKFwiPHByZS8+XCIpLnRleHQoYCR7bXNnfVxcbmApLmFwcGVuZFRvKFwiI2xvZ1wiKTtcclxuXHR9XHJcblx0cHVibGljIHN0YXRpYyBodG1sKGh0bWw6IHN0cmluZykge1xyXG5cdFx0JChcIjxkaXYvPlwiKS5odG1sKGh0bWwpLmFwcGVuZFRvKFwiI2xvZ1wiKTtcclxuXHR9XHJcbn1cclxuXHJcbmludGVyZmFjZSBQdXp6bGUge1xyXG5cdHRlc3QoYm9hcmQ6IEJvYXJkKTogbnVtYmVyO1xyXG5cdGdldFBpZWNlQ291bnQoKTogbnVtYmVyO1xyXG59XHJcblxyXG5jbGFzcyBQdXp6bGVEZW1vIGltcGxlbWVudHMgUHV6emxlIHtcclxuXHRwcml2YXRlIHNvbHV0aW9uOiBudW1iZXJbXSA9IFtdO1xyXG5cclxuXHRwdWJsaWMgY29uc3RydWN0b3Ioc29sdXRpb246IG51bWJlcltdKSB7XHJcblx0XHR0aGlzLnNvbHV0aW9uID0gc29sdXRpb247XHJcblx0XHRMb2cub3V0KGBQdXp6bGU6XFxuICAgJHtzb2x1dGlvbi5qb2luKFwiIFwiKX1gKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBzdGF0aWMgcmFuZG9tKGxlbmd0aDogbnVtYmVyKTogUHV6emxlIHtcclxuXHRcdHJldHVybiBuZXcgUHV6emxlRGVtbyhfLnNodWZmbGUoXy5tYXAoXHJcblx0XHRcdG5ldyBBcnJheShsZW5ndGgpLCBmdW5jdGlvbiAodiwgaykgeyByZXR1cm4gayArIDE7IH0pKSk7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZ2V0UGllY2VDb3VudCgpOiBudW1iZXIge1xyXG5cdFx0cmV0dXJuIHRoaXMuc29sdXRpb24ubGVuZ3RoO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHRlc3QoYm9hcmQ6IEJvYXJkKTogbnVtYmVyIHtcclxuXHRcdGxldCBjb3VudCA9IDA7XHJcblx0XHRmb3IgKGxldCBpID0gMCwgbGVuID0gdGhpcy5zb2x1dGlvbi5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG5cdFx0XHRsZXQgY29ycmVjdCA9IGJvYXJkLnBpZWNlc1tpXS5xdWFudGl0eSA9PSB0aGlzLnNvbHV0aW9uW2ldO1xyXG5cdFx0XHRpZiAoY29ycmVjdCkgY291bnQrKztcclxuXHRcdFx0aWYgKERFQlVHKSBib2FyZC5kZWJ1Z1ZpZXdDb3JyZWN0UGllY2VzW2ldID0gY29ycmVjdDtcclxuXHRcdH1cclxuXHRcdHJldHVybiBjb3VudDtcclxuXHR9XHJcbn1cclxuXHJcbmNsYXNzIEh1bWFuUHV6emxlSW50ZXJmYWNlIGltcGxlbWVudHMgUHV6emxlIHtcclxuXHRwcml2YXRlIHBpZWNlQ291bnQ6IG51bWJlcjtcclxuXHJcblx0cHVibGljIGNvbnN0cnVjdG9yKHBpZWNlQ291bnQ6IG51bWJlcikge1xyXG5cdFx0dGhpcy5waWVjZUNvdW50ID0gcGllY2VDb3VudDtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXRQaWVjZUNvdW50KCk6IG51bWJlciB7XHJcblx0XHRyZXR1cm4gdGhpcy5waWVjZUNvdW50O1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBsYXN0U2VxdWVuY2U6IG51bWJlcltdID0gW107XHJcblx0cHVibGljIHRlc3QoYm9hcmQ6IEJvYXJkKTogbnVtYmVyIHtcclxuXHRcdGxldCBhbnN3ZXI7XHJcblx0XHRkbyB7XHJcblx0XHRcdGxldCBuID0gXy5tYXAoYm9hcmQucGllY2VzLCAocykgPT4gcy5xdWFudGl0eSk7XHJcblx0XHRcdGxldCBkaXNwbGF5ID0gXy5tYXAobiwgKGQsIGkpID0+IHRoaXMubGFzdFNlcXVlbmNlLmxlbmd0aCA+IDAgJiYgZCA9PSB0aGlzLmxhc3RTZXF1ZW5jZVtpXSA/IGQgOiBgKCR7ZH0pYCk7XHJcblx0XHRcdHRoaXMubGFzdFNlcXVlbmNlID0gbjtcclxuXHRcdFx0YW5zd2VyID0gcGFyc2VJbnQocHJvbXB0KFxyXG5cdFx0XHRcdGBQbGVhc2UgaW5wdXQgdGhlIGZvbGxvd2luZyBzZXF1ZW5jZTpcXG5cXG4gICAgJHtkaXNwbGF5LmpvaW4oXCIgIFwiKX1cXG5cXG5BZnRlciBlYWNoIHBsYXllciBjbGlja3MgdGhlaXIgYmx1ZSBidXR0b25cXG5ob3cgbWFueSB5ZWxsb3cgbGlnaHRzIGFyZSBsaXQ/YCksIDEwKTtcclxuXHRcdH1cclxuXHRcdHdoaWxlIChpc05hTihhbnN3ZXIpKTtcclxuXHRcdHJldHVybiBhbnN3ZXI7XHJcblx0fVxyXG59XHJcblxyXG50eXBlIERlZHVjdGlvbiA9IFwiVVwiIHwgXCJNTlwiIHwgXCJOXCIgfCBcIk1ZXCIgfCBcIllcIjtcclxuY29uc3QgVU5LTk9XTiA9IFwiVVwiO1xyXG5jb25zdCBNQVlCRV9OTyA9IFwiTU5cIjtcclxuY29uc3QgTk8gPSBcIk5cIjtcclxuY29uc3QgTUFZQkVfWUVTID0gXCJNWVwiO1xyXG5jb25zdCBZRVMgPSBcIllcIjtcclxuXHJcbmNsYXNzIFN3YXAge1xyXG5cdHB1YmxpYyBhOiBudW1iZXI7XHJcblx0cHVibGljIGI6IG51bWJlcjtcclxuXHJcblx0cHVibGljIGNvbnN0cnVjdG9yKGE6IG51bWJlciwgYjogbnVtYmVyKSB7XHJcblx0XHR0aGlzLmEgPSBhO1xyXG5cdFx0dGhpcy5iID0gYjtcclxuXHR9XHJcbn1cclxuXHJcbmNsYXNzIE1vdmUge1xyXG5cdHB1YmxpYyBudW06IG51bWJlcjtcclxuXHRwdWJsaWMgYm9hcmQ6IEJvYXJkO1xyXG5cdHB1YmxpYyBjb3JyZWN0OiBudW1iZXI7IC8vIHNjb3JlXHJcblx0cHVibGljIGRlbHRhOiBudW1iZXI7IC8vIHNjb3JlXHJcblx0cHVibGljIHByZXY/OiBNb3ZlOyAvLyBwbGF5IHNlcXVlbmNlXHJcblx0cHVibGljIGJhc2U6IE1vdmU7IC8vIGNvcGllZCBmcm9tXHJcblx0cHVibGljIHN3YXA/OiBTd2FwO1xyXG5cclxuXHQvLyBuZXcgbW92ZSBiYXNlZCBvbiBjb3B5IG9mIGdpdmVuIG1vdmVcclxuXHRwdWJsaWMgY29uc3RydWN0b3IoYmFzZTogTW92ZSwgYm9hcmQ6IEJvYXJkLCBzd2FwPzogU3dhcCkge1xyXG5cdFx0dGhpcy5iYXNlID0gYmFzZTtcclxuXHRcdHRoaXMuYm9hcmQgPSBfLmNsb25lRGVlcChib2FyZCk7XHJcblx0XHRpZiAobnVsbCAhPSBzd2FwKSB7XHJcblx0XHRcdGxldCB0bXAgPSB0aGlzLmJvYXJkLnBpZWNlc1tzd2FwLmFdO1xyXG5cdFx0XHR0aGlzLmJvYXJkLnBpZWNlc1tzd2FwLmFdID0gdGhpcy5ib2FyZC5waWVjZXNbc3dhcC5iXTtcclxuXHRcdFx0dGhpcy5ib2FyZC5waWVjZXNbc3dhcC5iXSA9IHRtcDtcclxuXHRcdFx0dGhpcy5ib2FyZC5waWVjZXNbc3dhcC5hXS5pbmRleCA9IHN3YXAuYTtcclxuXHRcdFx0dGhpcy5ib2FyZC5waWVjZXNbc3dhcC5iXS5pbmRleCA9IHN3YXAuYjtcclxuXHRcdFx0dGhpcy5zd2FwID0gc3dhcDtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHB1YmxpYyByZW5kZXIoKSB7XHJcblx0XHRsZXQgcyA9IGAke3RoaXMubnVtfTogYDtcclxuXHRcdGZvciAobGV0IGkgPSAwLCBsZW4gPSB0aGlzLmJvYXJkLnBpZWNlcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG5cdFx0XHRsZXQgcGllY2UgPSB0aGlzLmJvYXJkLnBpZWNlc1tpXTtcclxuXHRcdFx0bGV0IHVuZGVybGluZSA9IChudWxsICE9IHRoaXMuc3dhcCAmJiAocGllY2UucXVhbnRpdHkgPT0gdGhpcy5ib2FyZC5waWVjZXNbdGhpcy5zd2FwLmFdLnF1YW50aXR5IHx8IHBpZWNlLnF1YW50aXR5ID09IHRoaXMuYm9hcmQucGllY2VzW3RoaXMuc3dhcC5iXS5xdWFudGl0eSkpO1xyXG5cdFx0XHRsZXQgYm9sZCA9IHRoaXMuYm9hcmQuZGVidWdWaWV3Q29ycmVjdFBpZWNlc1tpXTtcclxuXHRcdFx0cyArPSBgJHtib2xkID8gXCI8Yj5cIiA6IFwiXCJ9JHt1bmRlcmxpbmUgPyBcIihcIiA6IFwiXCJ9JHtwaWVjZS5xdWFudGl0eX0ke3VuZGVybGluZSA/IFwiKVwiIDogXCJcIn0ke2JvbGQgPyBcIjwvYj5cIiA6IFwiXCJ9IGA7XHJcblx0XHR9XHJcblx0XHRzICs9ICh0aGlzLm51bSA9PT0gMSA/IFwiRklSU1RcIiA6XHJcblx0XHRcdGAgPSAke3RoaXMuY29ycmVjdH0gKCR7dGhpcy5kZWx0YSA8IDAgPyB0aGlzLmRlbHRhIDogYCske3RoaXMuZGVsdGF9YH0pIHNjb3JlOiAke3RoaXMuc2NvcmUoKX1gKTtcclxuXHRcdExvZy5odG1sKHMpO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHNjb3JlKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuY29ycmVjdCArICh0aGlzLmRlbHRhICogLjUpXHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZ2V0U3dhcEEoKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5ib2FyZC5waWVjZXNbdGhpcy5zd2FwLmFdO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGdldFN3YXBCKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuYm9hcmQucGllY2VzW3RoaXMuc3dhcC5iXTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXRTd2FwSW5CYXNlKGs6IHN0cmluZykge1xyXG5cdFx0cmV0dXJuIF8uZmluZCh0aGlzLmJhc2UuYm9hcmQucGllY2VzLCAocykgPT5cclxuXHRcdFx0cy5xdWFudGl0eSA9PT0gdGhpcy5ib2FyZC5waWVjZXNbdGhpcy5zd2FwW2tdXS5xdWFudGl0eSk7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgaGFzU3dhcERlZHVjdGlvbihhOiBEZWR1Y3Rpb24sIGI6IERlZHVjdGlvbikge1xyXG5cdFx0cmV0dXJuIHRoaXMuZ2V0U3dhcEEoKS5kZWR1Y3Rpb24gPT0gYSAmJlxyXG5cdFx0XHR0aGlzLmdldFN3YXBCKCkuZGVkdWN0aW9uID09IGI7XHJcblx0fVxyXG5cclxuXHQvLyBUT0RPOiBmaW5kIHRoZSBhZGphY2VudCBwYWlyIGluIGdpdmVuIHR3byBtb3Zlc1xyXG5cdC8vIGFkaiBwYWlyIGluIHR3byBtb3ZlcyA9XHJcblx0Ly8gaWYgbW92ZTEgPSBhLGIgYW5kIG1vdmUyID0gYixjIHRoZW4gYWpjIHBhaXIgPSBhXHJcblxyXG5cdHB1YmxpYyBzdGF0aWMgY29weU1vc3RWYWx1YWJsZU1vdmUoaGlzdG9yeTogTW92ZVtdKTogTW92ZSB7XHJcblx0XHRsZXQgbW9zdFZhbHVhYmxlOiBNb3ZlO1xyXG5cdFx0Zm9yIChsZXQgaSA9IDAsIGxlbiA9IGhpc3RvcnkubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuXHRcdFx0bGV0IGN1cnJlbnQgPSBoaXN0b3J5W2ldO1xyXG5cdFx0XHRpZiAobnVsbCA9PSBtb3N0VmFsdWFibGUgfHwgbW9zdFZhbHVhYmxlLnNjb3JlKCkgPCBjdXJyZW50LnNjb3JlKCkpIHtcclxuXHRcdFx0XHRtb3N0VmFsdWFibGUgPSBjdXJyZW50O1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gbW9zdFZhbHVhYmxlLmNsb25lKCk7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgY2xvbmUoKTogTW92ZSB7XHJcblx0XHRsZXQgbW92ZSA9IG5ldyBNb3ZlKHRoaXMsIHRoaXMuYm9hcmQpO1xyXG5cdFx0bW92ZS5udW0gPSB0aGlzLm51bTtcclxuXHRcdG1vdmUuY29ycmVjdCA9IHRoaXMuY29ycmVjdDtcclxuXHRcdG1vdmUuZGVsdGEgPSB0aGlzLmRlbHRhO1xyXG5cdFx0cmV0dXJuIG1vdmU7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc3RhdGljIHJlamVjdFdhc3RlTW92ZShoaXN0b3J5OiBNb3ZlW10sIGNhbmRpZGF0ZTogTW92ZSk6IGJvb2xlYW4ge1xyXG5cdFx0Zm9yIChsZXQgaSA9IDAsIGxlbiA9IGhpc3RvcnkubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuXHRcdFx0bGV0IGN1cnJlbnQgPSBoaXN0b3J5W2ldO1xyXG5cclxuXHRcdFx0Ly8gcmVqZWN0IGlmIHRoaXMgYm9hcmQgaGFzIGJlZW4gcGxheWVkIGJlZm9yZVxyXG5cdFx0XHRpZiAoQm9hcmQuY29tcGFyZShjdXJyZW50LmJvYXJkLCBjYW5kaWRhdGUuYm9hcmQpKSB7XHJcblx0XHRcdFx0aWYgKERFQlVHKSBMb2cub3V0KGBSZWplY3RpbmcgYm9hcmQgcGxheWVkIGJlZm9yZSBhdCBtb3ZlICR7Y3VycmVudC5udW19ICR7Y2FuZGlkYXRlLmJvYXJkLnBpZWNlcy5qb2luKFwiIFwiKX1gKTtcclxuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0Zm9yIChsZXQgaSA9IDAsIGxlbiA9IGhpc3RvcnkubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuXHRcdFx0bGV0IGN1cnJlbnQgPSBoaXN0b3J5W2ldO1xyXG5cclxuXHRcdFx0Zm9yIChsZXQgaSA9IDAsIGxlbiA9IGN1cnJlbnQuYm9hcmQucGllY2VzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcblx0XHRcdFx0bGV0IGN1ciA9IGN1cnJlbnQuYm9hcmQucGllY2VzW2ldO1xyXG5cdFx0XHRcdGxldCBjYW4gPSBjYW5kaWRhdGUuYm9hcmQucGllY2VzW2ldO1xyXG5cclxuXHRcdFx0XHQvLyByZWplY3QgaWYgaGlzdG9yeSBjb250YWlucyBhIFlFUyB0aGF0IGlzbid0IGluY2x1ZGVkIGhlcmVcclxuXHRcdFx0XHRpZiAoWUVTID09PSBjdXIuZGVkdWN0aW9uICYmIGNhbi5xdWFudGl0eSAhPT0gY3VyLnF1YW50aXR5KSB7XHJcblx0XHRcdFx0XHRpZiAoREVCVUcpIExvZy5vdXQoYFJlamVjdGluZyBpbmRleCAke2Nhbi5xdWFudGl0eX0ke2Nhbi5kZWR1Y3Rpb24uc3Vic3RyKDAsIDIpfUAke2Nhbi5pbmRleH0gd2hpY2ggd2FzICR7Y3VyLnF1YW50aXR5fSR7Y3VyLmRlZHVjdGlvbi5zdWJzdHIoMCwgMil9QCR7Y3VyLmluZGV4fSBiZWZvcmUgYXQgbW92ZSAke2N1cnJlbnQubnVtfWApO1xyXG5cdFx0XHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHQvLyByZWplY3QgaWYgaGlzdG9yeSBjb250YWlucyBhIE5PIHRoYXQgaXMgaW5jbHVkZWQgYWdhaW4gaGVyZVxyXG5cdFx0XHRcdGlmIChOTyA9PT0gY3VyLmRlZHVjdGlvbiAmJiBjYW4ucXVhbnRpdHkgPT09IGN1ci5xdWFudGl0eSkge1xyXG5cdFx0XHRcdFx0aWYgKERFQlVHKSBMb2cub3V0KGBSZWplY3RpbmcgaW5kZXggJHtjYW4ucXVhbnRpdHl9JHtjYW4uZGVkdWN0aW9uLnN1YnN0cigwLCAyKX1AJHtjYW4uaW5kZXh9IHdoaWNoIHdhcyAke2N1ci5xdWFudGl0eX0ke2N1ci5kZWR1Y3Rpb24uc3Vic3RyKDAsIDIpfUAke2N1ci5pbmRleH0gYmVmb3JlIGF0IG1vdmUgJHtjdXJyZW50Lm51bX1gKTtcclxuXHRcdFx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIGZhbHNlO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHN0YXRpYyBjcm9zc0pvaW5DYW5kaWRhdGVzKGNhbmRpZGF0ZXM6IFBpZWNlW10pIHtcclxuXHRcdGxldCByZXN1bHQ6IFBpZWNlW10gPSBbXTtcclxuXHRcdGZvciAobGV0IHggPSAwLCB4bGVuID0gY2FuZGlkYXRlcy5sZW5ndGg7IHggPCB4bGVuOyB4KyspIHtcclxuXHRcdFx0Zm9yIChsZXQgeSA9IDAsIHlsZW4gPSBjYW5kaWRhdGVzLmxlbmd0aDsgeSA8IHlsZW47IHkrKykge1xyXG5cdFx0XHRcdGlmICh4ICE9IHkpXHJcblx0XHRcdFx0XHRyZXN1bHQucHVzaChjYW5kaWRhdGVzW3hdLCBjYW5kaWRhdGVzW3ldKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHJlc3VsdDtcclxuXHR9XHJcbn1cclxuXHJcbmNsYXNzIFBpZWNlIHtcclxuXHRwdWJsaWMgaW5kZXg6IG51bWJlcjtcclxuXHRwdWJsaWMgcXVhbnRpdHk6IG51bWJlcjtcclxuXHRwdWJsaWMgZGVkdWN0aW9uOiBEZWR1Y3Rpb247XHJcblxyXG5cdHB1YmxpYyBzZXREZWR1Y3Rpb24oZGVkdWN0aW9uOiBEZWR1Y3Rpb24sIGJvYXJkOiBCb2FyZCwgaW5kZXg6IG51bWJlcikge1xyXG5cdFx0aWYgKFlFUyA9PT0gdGhpcy5kZWR1Y3Rpb24gfHwgTk8gPT09IHRoaXMuZGVkdWN0aW9uKSByZXR1cm47IC8vIGhhcmQgY29uY2x1c2lvbnMgdG8gY2hhbmdlXHJcblx0XHRpZiAoREVCVUcpIHtcclxuXHRcdFx0TG9nLm91dChgICAgICR7dGhpcy5xdWFudGl0eX0ke3RoaXMuZGVkdWN0aW9uLnN1YnN0cigwLCAyKX1AJHt0aGlzLmluZGV4fSA9PiAke2RlZHVjdGlvbi5zdWJzdHIoMCwgMil9JHtkZWR1Y3Rpb24gPT0gWUVTID8gXCIgRk9VTkRcIiA6IFwiXCJ9YCk7XHJcblx0XHRcdGlmIChZRVMgPT09IGRlZHVjdGlvbiAmJiAhYm9hcmQuZGVidWdWaWV3Q29ycmVjdFBpZWNlc1tpbmRleF0pIHtcclxuXHRcdFx0XHRMb2cub3V0KGAgICAgICBidXQgaXRzIHdyb25nYCk7XHJcblx0XHRcdFx0ZGVidWdnZXI7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHRoaXMuZGVkdWN0aW9uID0gZGVkdWN0aW9uO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHRvU3RyaW5nKCkge1xyXG5cdFx0cmV0dXJuIGAke3RoaXMucXVhbnRpdHl9JHt0aGlzLmRlZHVjdGlvbi5zdWJzdHIoMCwgMil9QCR7dGhpcy5pbmRleH1gO1xyXG5cdH1cclxufVxyXG5cclxuXHJcbmNsYXNzIEJvYXJkIHtcclxuXHRwdWJsaWMgcGllY2VzOiBQaWVjZVtdO1xyXG5cdHB1YmxpYyBkZWJ1Z1ZpZXdDb3JyZWN0UGllY2VzOiBib29sZWFuW10gPSBbXTtcclxuXHJcblx0cHVibGljIGNvbnN0cnVjdG9yKHBpZWNlczogUGllY2VbXSkge1xyXG5cdFx0dGhpcy5waWVjZXMgPSBwaWVjZXM7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZmluZEFsbChmbikge1xyXG5cdFx0cmV0dXJuIF8uZmlsdGVyKHRoaXMucGllY2VzLCBmbik7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZmluZE9uZShmbikge1xyXG5cdFx0cmV0dXJuIHRoaXMuZmluZEFsbChmbilbMF07XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc3RhdGljIGNvbXBhcmUoYTogQm9hcmQsIGI6IEJvYXJkKSB7XHJcblx0XHRpZiAoYS5waWVjZXMubGVuZ3RoICE9IGIucGllY2VzLmxlbmd0aCkgcmV0dXJuIGZhbHNlO1xyXG5cdFx0Zm9yIChsZXQgaSA9IDAsIGxlbiA9IGEucGllY2VzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcblx0XHRcdGlmIChhLnBpZWNlc1tpXS5xdWFudGl0eSAhPSBiLnBpZWNlc1tpXS5xdWFudGl0eSkge1xyXG5cdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHRydWU7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgcmVuZGVyKCkge1xyXG5cdFx0Zm9yIChsZXQgaSA9IDAsIGxlbiA9IHRoaXMucGllY2VzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcblx0XHRcdCQoXCJ0ZCNjXCIgKyBpKS50ZXh0KHRoaXMucGllY2VzW2ldLnF1YW50aXR5ICsgXCIgXCIgKyB0aGlzLnBpZWNlc1tpXS5kZWR1Y3Rpb24uc3Vic3RyKDAsIDIpKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHB1YmxpYyB0b1N0cmluZygpIHtcclxuXHRcdHJldHVybiB0aGlzLnBpZWNlcy5qb2luKFwiIFwiKTtcclxuXHR9XHJcbn1cclxuXHJcbmNsYXNzIFNvbHZlciB7XHJcblx0cHJpdmF0ZSBwdXp6bGU6IFB1enpsZTtcclxuXHRwcml2YXRlIG1vdmVzOiBudW1iZXIgPSAwO1xyXG5cdHB1YmxpYyByb290TW92ZTogTW92ZTsgLy8gcm9vdCBCU1Qgbm9kZVxyXG5cdHB1YmxpYyBsYXN0TW92ZTogTW92ZTsgLy8gaGlzdG9yeSBvZiBwbGF5ZWQgbW92ZXNcclxuXHRwdWJsaWMga25vd246IFBpZWNlW107XHJcblx0cHVibGljIHVua25vd246IFBpZWNlW107XHJcblxyXG5cdHB1YmxpYyBjb25zdHJ1Y3RvcihwdXp6bGU6IFB1enpsZSkge1xyXG5cdFx0dGhpcy5wdXp6bGUgPSBwdXp6bGU7XHJcblxyXG5cdFx0Ly8gYmVnaW4gd2l0aCBvcGVuaW5nIG1vdmVcclxuXHRcdHRoaXMucm9vdE1vdmUgPSBuZXcgTW92ZShudWxsLCBuZXcgQm9hcmQoXy5tYXAoXHJcblx0XHRcdG5ldyBBcnJheSh0aGlzLnB1enpsZS5nZXRQaWVjZUNvdW50KCkpLFxyXG5cdFx0XHQobmlsLCBpKSA9PiB7XHJcblx0XHRcdFx0bGV0IHBpZWNlID0gbmV3IFBpZWNlKCk7XHJcblx0XHRcdFx0cGllY2UuaW5kZXggPSBpO1xyXG5cdFx0XHRcdHBpZWNlLnF1YW50aXR5ID0gaSArIDE7XHJcblx0XHRcdFx0cGllY2UuZGVkdWN0aW9uID0gVU5LTk9XTjtcclxuXHRcdFx0XHRyZXR1cm4gcGllY2U7XHJcblx0XHRcdH0pKSk7XHJcblx0XHRcdF8ubWFwKHRoaXMucm9vdE1vdmUuYm9hcmQucGllY2VzLCAocGllY2UpID0+IHRoaXMudW5rbm93bi5wdXNoKHBpZWNlKSk7XHJcblx0XHR0aGlzLnBsYXlNb3ZlKHRoaXMucm9vdE1vdmUpO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGdldEhpc3RvcnkoKSB7XHJcblx0XHRsZXQgY3VycmVudCA9IHRoaXMubGFzdE1vdmU7XHJcblx0XHRsZXQgaGlzdG9yeTogTW92ZVtdID0gW107XHJcblx0XHR3aGlsZSAobnVsbCAhPSBjdXJyZW50KSB7XHJcblx0XHRcdGhpc3RvcnkucHVzaChjdXJyZW50KTtcclxuXHRcdFx0Y3VycmVudCA9IGN1cnJlbnQucHJldjtcclxuXHRcdH1cclxuXHRcdHJldHVybiBoaXN0b3J5O1xyXG5cdH1cclxuXHJcblx0cHVibGljIHBsYXlNb3ZlKG1vdmU6IE1vdmUpIHtcclxuXHRcdC8vIHNlcXVlbmNlIG1vdmUgaW50byBwbGF5XHJcblx0XHRtb3ZlLm51bSA9ICsrdGhpcy5tb3ZlcztcclxuXHRcdG1vdmUucHJldiA9IHRoaXMubGFzdE1vdmU7XHJcblx0XHR0aGlzLmxhc3RNb3ZlID0gbW92ZTtcclxuXHJcblx0XHQvLyB0ZXN0IGFuZCBzY29yZSB0aGUgbW92ZVxyXG5cdFx0bW92ZS5jb3JyZWN0ID0gdGhpcy5wdXp6bGUudGVzdChtb3ZlLmJvYXJkKTtcclxuXHRcdG1vdmUuZGVsdGEgPSBtb3ZlLmNvcnJlY3QgLSAobnVsbCAhPSBtb3ZlLmJhc2UgPyBtb3ZlLmJhc2UuY29ycmVjdCB8fCAwIDogMCk7XHJcblx0XHRpZiAodGhpcy5tb3ZlcyA+IE1BWF9HVUVTU0VTKSB7XHJcblx0XHRcdExvZy5vdXQoXCJUb28gbWFueSBndWVzc2VzOyB3ZSBsb3NlLlwiKTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cdFx0Ly8gdXBkYXRlIHVzZXIgdmlld1xyXG5cdFx0bW92ZS5ib2FyZC5yZW5kZXIoKTtcclxuXHRcdG1vdmUucmVuZGVyKCk7XHJcblx0XHRpZiAobW92ZS5jb3JyZWN0ID49IHRoaXMucHV6emxlLmdldFBpZWNlQ291bnQoKSkge1xyXG5cdFx0XHRMb2cub3V0KGBZb3Ugd2luIGluICR7dGhpcy5tb3Zlc30gbW92ZXMuYCk7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHRcdGlmIChudWxsICE9IG1vdmUuc3dhcCkge1xyXG5cdFx0XHQvLyBhcHBseSBzd2FwIGRlZHVjdGlvbnNcclxuXHRcdFx0aWYgKG1vdmUuZGVsdGEgPT0gMCkge1xyXG5cdFx0XHRcdC8vIG5vIGRpZmZlcmVuY2U7IGJvdGggbXVzdCBiZSBOT1xyXG5cdFx0XHRcdG1vdmUuZ2V0U3dhcEEoKS5zZXREZWR1Y3Rpb24oTk8sIG1vdmUuYm9hcmQsIG1vdmUuc3dhcC5hKTtcclxuXHRcdFx0XHRtb3ZlLmdldFN3YXBCKCkuc2V0RGVkdWN0aW9uKE5PLCBtb3ZlLmJvYXJkLCBtb3ZlLnN3YXAuYik7XHJcblx0XHRcdFx0bW92ZS5nZXRTd2FwSW5CYXNlKFwiYVwiKS5zZXREZWR1Y3Rpb24oTk8sIG1vdmUuYmFzZS5ib2FyZCwgbW92ZS5zd2FwLmEpO1xyXG5cdFx0XHRcdG1vdmUuZ2V0U3dhcEluQmFzZShcImJcIikuc2V0RGVkdWN0aW9uKE5PLCBtb3ZlLmJhc2UuYm9hcmQsIG1vdmUuc3dhcC5iKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlIGlmIChtb3ZlLmRlbHRhID09IDEpIHtcclxuXHRcdFx0XHQvLyBkaWZmZXJlbmNlOyBvbmUgaXMgbm93IHJpZ2h0LCBidXQgd2UgZG9uJ3Qga25vdyB3aGljaFxyXG5cdFx0XHRcdG1vdmUuZ2V0U3dhcEEoKS5zZXREZWR1Y3Rpb24oTUFZQkVfWUVTLCBtb3ZlLmJvYXJkLCBtb3ZlLnN3YXAuYSk7XHJcblx0XHRcdFx0bW92ZS5nZXRTd2FwQigpLnNldERlZHVjdGlvbihNQVlCRV9ZRVMsIG1vdmUuYm9hcmQsIG1vdmUuc3dhcC5iKTtcclxuXHRcdFx0XHQvL21vdmUuZ2V0U3dhcEluQmFzZShcImFcIikuc2V0RGVkdWN0aW9uKE1BWUJFX05PLCBtb3ZlLmJhc2UuYm9hcmQsIG1vdmUuc3dhcC5hKTtcclxuXHRcdFx0XHQvL21vdmUuZ2V0U3dhcEluQmFzZShcImJcIikuc2V0RGVkdWN0aW9uKE1BWUJFX05PLCBtb3ZlLmJhc2UuYm9hcmQsIG1vdmUuc3dhcC5iKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlIGlmIChtb3ZlLmRlbHRhID09IDIpIHtcclxuXHRcdFx0XHQvLyB2ZXJ5IHBvc2l0aXZlIGRpZmZlcmVuY2U7IGJvdGggYXJlIG5vdyByaWdodCBmb3Igc3VyZVxyXG5cdFx0XHRcdG1vdmUuZ2V0U3dhcEEoKS5zZXREZWR1Y3Rpb24oWUVTLCBtb3ZlLmJvYXJkLCBtb3ZlLnN3YXAuYSk7XHJcblx0XHRcdFx0bW92ZS5nZXRTd2FwQigpLnNldERlZHVjdGlvbihZRVMsIG1vdmUuYm9hcmQsIG1vdmUuc3dhcC5iKTtcclxuXHJcblxyXG5cdFx0XHRcdG1vdmUuZ2V0U3dhcEluQmFzZShcImFcIikuc2V0RGVkdWN0aW9uKE5PLCBtb3ZlLmJhc2UuYm9hcmQsIG1vdmUuc3dhcC5hKTtcclxuXHRcdFx0XHRtb3ZlLmdldFN3YXBJbkJhc2UoXCJiXCIpLnNldERlZHVjdGlvbihOTywgbW92ZS5iYXNlLmJvYXJkLCBtb3ZlLnN3YXAuYik7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSBpZiAobW92ZS5kZWx0YSA9PSAtMSkge1xyXG5cdFx0XHRcdC8vIGRpZmZlcmVuY2U7IG9uZSB3YXMgcmlnaHQsIGJ1dCB3ZSBkb24ndCBrbm93IHdoaWNoXHJcblx0XHRcdFx0Ly9tb3ZlLmdldFN3YXBBKCkuc2V0RGVkdWN0aW9uKE1BWUJFLCBtb3ZlLmJvYXJkLCBtb3ZlLnN3YXAuYSk7XHJcblx0XHRcdFx0Ly9tb3ZlLmdldFN3YXBCKCkuc2V0RGVkdWN0aW9uKE1BWUJFLCBtb3ZlLmJvYXJkLCBtb3ZlLnN3YXAuYik7XHJcblx0XHRcdFx0bW92ZS5nZXRTd2FwSW5CYXNlKFwiYVwiKS5zZXREZWR1Y3Rpb24oTUFZQkVfWUVTLCBtb3ZlLmJhc2UuYm9hcmQsIG1vdmUuc3dhcC5hKTtcclxuXHRcdFx0XHRtb3ZlLmdldFN3YXBJbkJhc2UoXCJiXCIpLnNldERlZHVjdGlvbihNQVlCRV9ZRVMsIG1vdmUuYmFzZS5ib2FyZCwgbW92ZS5zd2FwLmIpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2UgaWYgKG1vdmUuZGVsdGEgPT0gLTIpIHtcclxuXHJcbi8vIFRPRE86IGFmZmVjdCBzY29yZSBvZiBwcmV2aW91cyBtb3ZlcyB0byByZS1ldmFsdWF0ZSBoaWdoZXN0IHNjb3JlIG9uIG5leHQgbW92ZVxyXG4vLyBzaW5jZSB3ZSBsZWFybiB0aGluZ3MgYWJvdXQgcHJpb3IgbW92ZXMgYWxsIHRoZSB0aW1lXHJcblxyXG5cdFx0XHRcdC8vIGRpZmZlcmVuY2U7IGJvdGggd2VyZSByaWdodCBmb3Igc3VyZVxyXG5cdFx0XHRcdG1vdmUuZ2V0U3dhcEEoKS5zZXREZWR1Y3Rpb24oTk8sIG1vdmUuYm9hcmQsIG1vdmUuc3dhcC5hKTtcclxuXHRcdFx0XHRtb3ZlLmdldFN3YXBCKCkuc2V0RGVkdWN0aW9uKE5PLCBtb3ZlLmJvYXJkLCBtb3ZlLnN3YXAuYik7XHJcblx0XHRcdFx0bW92ZS5nZXRTd2FwSW5CYXNlKFwiYVwiKS5zZXREZWR1Y3Rpb24oWUVTLCBtb3ZlLmJhc2UuYm9hcmQsIG1vdmUuc3dhcC5hKTtcclxuXHRcdFx0XHRtb3ZlLmdldFN3YXBJbkJhc2UoXCJiXCIpLnNldERlZHVjdGlvbihZRVMsIG1vdmUuYmFzZS5ib2FyZCwgbW92ZS5zd2FwLmIpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5kZWNpZGUoKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBkZWNpZGUoKSB7XHJcblx0XHQvLyBkZWNpZGUgd2hhdCB0byBkbyBuZXh0XHJcblx0XHRsZXQgbmV4dE1vdmU6IE1vdmU7XHJcblx0XHRsZXQgY2FuZGlkYXRlczogUGllY2VbXTtcclxuXHRcdGxldCB1LCB4O1xyXG5cdFx0aWYgKDEgPT09IHRoaXMubW92ZXMpIHsgLy8gZm9sbG93LXVwIHRvIGZpcnN0IG1vdmVcclxuXHRcdFx0Ly8ganVzdCBwbGF5IGEgc3dhcCBvZiB0aGUgZmlyc3QgdHdvIHBvc2l0aW9uc1xyXG5cdFx0XHRuZXh0TW92ZSA9IG5ldyBNb3ZlKHRoaXMubGFzdE1vdmUsIHRoaXMubGFzdE1vdmUuYm9hcmQsIG5ldyBTd2FwKDAsIDEpKTtcclxuXHRcdH1cclxuXHRcdGVsc2UgeyAvLyBzdWJzZXF1ZW50IG1vdmVzXHJcblx0XHRcdGxldCBtb3ZlID0gTW92ZS5jb3B5TW9zdFZhbHVhYmxlTW92ZSh0aGlzLmdldEhpc3RvcnkoKSk7XHJcblx0XHRcdC8vIHRyeSBhIHVuaXF1ZSBuZXcgc3dhcCBmcm9tIG5vbi15ZXMgZGVkdWN0aW9uc1xyXG5cdFx0XHRsZXQgdHJpZXMgPSAwO1xyXG5cdFx0XHRkbyB7XHJcblx0XHRcdFx0bGV0IHJhbmsgPSB7IE1BWUJFX1lFUzogMSwgTk86IDIsIFVOS05PV046IDMsIE1BWUJFX05POiA0IH07XHJcblx0XHRcdFx0aWYgKG51bGwgPT0gY2FuZGlkYXRlcykge1xyXG5cdFx0XHRcdFx0Y2FuZGlkYXRlcyA9IF8uZmlsdGVyKG1vdmUuYm9hcmQucGllY2VzLCAocykgPT5cclxuXHRcdFx0XHRcdFx0Xy5pbmNsdWRlcyhbVU5LTk9XTiwgTUFZQkVfTk8sIE1BWUJFX1lFUywgTk9dLCBzLmRlZHVjdGlvbikpO1xyXG5cdFx0XHRcdFx0Y2FuZGlkYXRlcyA9IF8uc29ydEJ5KGNhbmRpZGF0ZXMsIChzKSA9PiByYW5rW3MuZGVkdWN0aW9uXSk7XHJcblx0XHRcdFx0XHRjYW5kaWRhdGVzID0gTW92ZS5jcm9zc0pvaW5DYW5kaWRhdGVzKGNhbmRpZGF0ZXMpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRcdExvZy5vdXQoYHJlcGVhdGVkIHdoaWxlOiAke3h9LCAke3V9YCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdExvZy5vdXQoXy5tYXAoY2FuZGlkYXRlcywgKHMpID0+IGAke3MucXVhbnRpdHl9JHtzLmRlZHVjdGlvbi5zdWJzdHIoMCwgMil9QCR7cy5pbmRleH1gKS5qb2luKFwiIFwiKSk7XHJcblx0XHRcdFx0bGV0IGEgPSBjYW5kaWRhdGVzLnNoaWZ0KCkuaW5kZXgsIGIgPSBjYW5kaWRhdGVzLnNoaWZ0KCkuaW5kZXg7XHJcblx0XHRcdFx0bmV4dE1vdmUgPSBuZXcgTW92ZShtb3ZlLCBtb3ZlLmJvYXJkLCBuZXcgU3dhcChhLCBiKSk7XHJcblx0XHRcdH1cclxuXHRcdFx0d2hpbGUgKFxyXG5cdFx0XHRcdCh4ID0gTW92ZS5yZWplY3RXYXN0ZU1vdmUodGhpcy5nZXRIaXN0b3J5KCksIG5leHRNb3ZlKSlcclxuXHRcdFx0XHQmJiAodSA9IHRyaWVzKyspIDwgTE9PUF9CUkVBS0VSKTtcclxuXHRcdFx0aWYgKERFQlVHICYmIHRyaWVzID4gTE9PUF9CUkVBS0VSKSBMb2cub3V0KFwiY2FuZGlkYXRlcyBub3Qgb3JpZ2luYWwgZW5vdWdoOyBleGhhdXN0aW5nIHJldHJpZXNcIik7XHJcblx0XHRcdExvZy5vdXQoYGVzY2FwZWQgd2hpbGU6ICR7eH0sICR7dX1gKTtcclxuXHRcdH1cclxuXHRcdGlmIChudWxsID09IG5leHRNb3ZlKSB7XHJcblx0XHRcdExvZy5vdXQoXCJVbmFibGUgdG8gZmluZCBuZXh0IG1vdmUuXCIpO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0c2V0VGltZW91dCgoKSA9PiB0aGlzLnBsYXlNb3ZlKG5leHRNb3ZlKSwgR1VFU1NfREVMQVkpO1xyXG5cdH1cclxufVxyXG5cclxuY29uc3QgTE9PUF9CUkVBS0VSID0gOTk5O1xyXG5jb25zdCBHVUVTU19ERUxBWSA9IDUwOyAvLyBtc1xyXG5jb25zdCBNQVhfR1VFU1NFUyA9IDEzO1xyXG5jb25zdCBTTE9UX0NPVU5UID0gNjtcclxuXHJcbmxldCBwdXp6bGU7XHJcbmlmIChERUJVRykge1xyXG5cdC8vcHV6emxlID0gUHV6emxlRGVtby5yYW5kb20oU0xPVF9DT1VOVCk7XHJcblx0cHV6emxlID0gbmV3IFB1enpsZURlbW8oWzEsIDYsIDMsIDUsIDQsIDJdKTtcclxuXHQvL3B1enpsZSA9IG5ldyBQdXp6bGVEZW1vKFsyLCAzLCA0LCAxLCA2LCA1XSk7XHJcblx0Ly9wdXp6bGUgPSBuZXcgUHV6emxlRGVtbyhbMiwgNCwgNiwgMSwgNSwgM10pO1xyXG5cdC8vcHV6emxlID0gbmV3IFB1enpsZURlbW8oWzIsIDEsIDUsIDYsIDMsIDRdKTtcclxuXHQvLyBUT0RPOiB0cnkgYSBwdXp6bGUgd2hlcmUgbnVtYmVycyBjYW4gcmVwZWF0XHJcbn1cclxuZWxzZSB7XHJcblx0cHV6emxlID0gbmV3IEh1bWFuUHV6emxlSW50ZXJmYWNlKFNMT1RfQ09VTlQpO1xyXG59XHJcbm5ldyBTb2x2ZXIocHV6emxlKTsiXX0=