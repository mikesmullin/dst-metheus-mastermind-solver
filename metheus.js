/// <reference path="node_modules/@types/jquery/index.d.ts" />
/// <reference path="node_modules/@types/lodash/index.d.ts" />
var DEBUG = true;
var Log = (function () {
    function Log() {
    }
    Log.out = function (msg) {
        $("<pre/>").text(msg + "\n").appendTo("#log");
    };
    Log.html = function (html) {
        $("<div/>").html(html).appendTo("#log");
    };
    return Log;
}());
var PuzzleDemo = (function () {
    function PuzzleDemo(solution) {
        this.solution = [];
        this.solution = solution;
        Log.out("Puzzle:\n" + solution.join("  "));
    }
    PuzzleDemo.random = function (length) {
        return new PuzzleDemo(_.shuffle(_.map(new Array(length), function (v, k) { return k + 1; })));
    };
    PuzzleDemo.prototype.getSlotCount = function () {
        return this.solution.length;
    };
    PuzzleDemo.prototype.test = function (board) {
        var count = 0;
        for (var i = 0, len = this.solution.length; i < len; i++) {
            var correct = board.slots[i].quantity == this.solution[i];
            if (correct)
                count++;
            if (DEBUG)
                board.debugViewCorrectSlots[i] = correct;
        }
        return count;
    };
    return PuzzleDemo;
}());
var HumanPuzzleInterface = (function () {
    function HumanPuzzleInterface(slotCount) {
        this.slotCount;
    }
    HumanPuzzleInterface.prototype.getSlotCount = function () {
        return this.slotCount;
    };
    HumanPuzzleInterface.prototype.test = function (board) {
        var answer;
        do {
            answer = parseInt(prompt("Please try:\n\t" + board + "\n\nHow many are correct?"), 10);
        } while (!isNaN(answer));
        return answer;
    };
    return HumanPuzzleInterface;
}());
var UNKNOWN = "UNKNOWN";
var NO = "NO";
var MAYBE = "MAYBE";
var YES = "YES";
var Swap = (function () {
    function Swap(a, b) {
        this.a = a;
        this.b = b;
    }
    return Swap;
}());
var Move = (function () {
    // new move based on copy of given board
    function Move(board, swap) {
        this.board = _.cloneDeep(board);
        if (null != swap) {
            var tmp = this.board.slots[swap.a];
            this.board.slots[swap.a] = this.board.slots[swap.b];
            this.board.slots[swap.b] = tmp;
            this.board.slots[swap.a].index = swap.a;
            this.board.slots[swap.b].index = swap.b;
            this.swap = swap;
        }
    }
    Move.prototype.render = function () {
        var s = "";
        for (var i = 0, len = this.board.slots.length; i < len; i++) {
            var slot = this.board.slots[i];
            var underline = (null != this.swap && (slot.quantity == this.board.slots[this.swap.a].quantity || slot.quantity == this.board.slots[this.swap.b].quantity));
            var bold = this.board.debugViewCorrectSlots[i];
            s += "" + (bold ? "<b>" : "") + (underline ? "<u>" : "") + slot.quantity + slot.deduction[0] + (underline ? "</u>" : "") + (bold ? "</b>" : "") + " ";
        }
        s += " = " + this.correct + " (" + (this.delta < 0 ? this.delta : "+" + this.delta) + ")";
        Log.html(s);
    };
    Move.prototype.score = function () {
        return this.correct + this.delta;
    };
    Move.rankInsert = function (root, move) {
        var parent = null;
        var current = move;
        while (true) {
            parent = current;
            if (move.score() < parent.score()) {
                current = parent.left;
                if (null == current) {
                    parent.left = move;
                    return;
                }
            }
            else {
                current = parent.right;
                if (null == current) {
                    parent.right = move;
                    return;
                }
            }
        }
    };
    Move.findMostValuableMove = function (root) {
        if (null == root)
            return null;
        var current = root;
        var lastHighScore = current;
        while (true) {
            if (current.score() > lastHighScore.score()) {
                current = current.left;
            }
            else {
                current = current.right;
            }
            if (null == current) {
                return lastHighScore;
            }
        }
    };
    return Move;
}());
var Slot = (function () {
    function Slot() {
    }
    Slot.prototype.setDeduction = function (deduction) {
        this.deduction = deduction;
        Log.out("          " + this.quantity + " " + this.deduction[0] + " => " + deduction[0] + (deduction == YES ? " FOUND" : ""));
    };
    Slot.prototype.toString = function () {
        return this.quantity;
    };
    return Slot;
}());
var Board = (function () {
    function Board(slots) {
        this.debugViewCorrectSlots = [];
        this.slots = slots;
    }
    Board.prototype.findAll = function (fn) {
        return _.filter(this.slots, fn);
    };
    Board.prototype.findOne = function (fn) {
        return this.findAll(fn)[0];
    };
    // find the adjacent pair in given two moves
    // adj pair in two moves =
    // if move1 = a,b and move2 = b,c then ajc pair = a
    Board.prototype.setDeduction = function () {
    };
    Board.prototype.render = function () {
        for (var i = 0, len = this.slots.length; i < len; i++) {
            $("td#c" + i).text(this.slots[i].quantity + " " + this.slots[i].deduction[0]);
        }
    };
    Board.prototype.toString = function () {
        return this.slots.join(" ");
    };
    return Board;
}());
var Solver = (function () {
    function Solver(puzzle) {
        this.moves = 0;
        this.puzzle = puzzle;
        // begin with opening move
        this.rootMove = new Move(new Board(_.map(new Array(this.puzzle.getSlotCount()), function (nil, i) {
            var slot = new Slot();
            slot.index = i;
            slot.quantity = i + 1;
            slot.deduction = UNKNOWN;
            return slot;
        })));
        this.playMove(this.rootMove);
    }
    Solver.prototype.playMove = function (move) {
        var _this = this;
        // sequence move into play
        move.num = ++this.moves;
        move.prev = this.lastMove;
        this.lastMove = move;
        // test and score the move
        if (this.moves > MAX_GUESSES) {
            Log.out("Too many guesses; we lose.");
            return;
        }
        else {
            var correct = this.puzzle.test(move.board);
            var delta = correct - (null != move ? move.correct || 0 : 0);
            Move.rankInsert(this.rootMove, move);
            move.board.render();
            move.correct = correct;
            move.delta = delta;
            move.render();
            if (correct == this.puzzle.getSlotCount()) {
                Log.out("You win in " + this.moves + " moves.");
                return;
            }
        }
        // decide what to do next
        if (null != move.swap) {
            if (move.delta == 0) {
                // no difference; both must be NO?
                move.swap.a.setDeduction(NO);
                move.swap.b.setDeduction(NO);
            }
            else if (move.delta == 1) {
                // difference; one is now right, but we don't know which
                // unless we have history to narrow it, then we have specific match
                move.swap.a.setDeduction(MAYBE);
                move.swap.b.setDeduction(MAYBE);
            }
            else if (move.delta == 2) {
                // very positive difference; both are now right for sure
                move.swap.a.setDeduction(YES);
                move.swap.b.setDeduction(YES);
            }
            else if (move.delta == -1) {
                // difference; one was right, but we don't know which
                // so first step is always to put it back
                move.swap.a.setDeduction(MAYBE);
                move.swap.b.setDeduction(MAYBE);
                this.rollback();
            }
            else if (move.delta == -2) {
                // difference; both were right for sure
                move.swap.a.setDeduction(YES);
                move.swap.b.setDeduction(YES);
                this.rollback();
            }
        }
        setTimeout(function () { return _this.playMove(_this.newMove(a, b)); }, GUESS_DELAY);
    };
    // determine whether a quantity has ever had a given deduction at a specific index in entire history
    Solver.prototype.hadDeductionAtIndex = function (quantity, index, deduction) {
        while (null != this.lastMove.swap) {
            var pair = this.lastMove.swap;
            if ((pair.a.quantity == quantity &&
                pair.a.deduction == deduction &&
                pair.a.index == index) ||
                (pair.b.quantity == quantity &&
                    pair.b.deduction == deduction &&
                    pair.b.index == index)) {
                Log.out(quantity + " index " + index + " deduction " + deduction[0] + " happened before at move " + this.lastMove.num);
                return true;
            }
            this.lastMove = this.lastMove.prev;
        }
        return false;
    };
    Solver.prototype.alreadyTried = function (q1, i1, q2, i2) {
        while (null != this.lastMove.swap) {
            var pair = this.lastMove.swap;
            if ((pair.a.quantity == q1 &&
                pair.a.index == i1) ||
                (pair.b.quantity == q2 &&
                    pair.b.index == i2)) {
                Log.out(q1 + ":" + i1 + "," + q2 + ":" + i2 + " happened before at move " + this.lastMove.num);
                return true;
            }
            this.lastMove = this.lastMove.prev;
        }
        return false;
    };
    Solver.prototype.rollback = function () {
        Log.out("rollback");
        var move = new Move(this.lastMove.board, this.lastMove.swap.a.index, this.lastMove.swap.b.index);
        // assume result is same as before
        move.correct = this.lastMove.correct;
        move.delta = this.lastMove.delta * -1; // assume opposite
    };
    return Solver;
}());
var GUESS_DELAY = 50; // ms
var MAX_GUESSES = 99;
var SLOT_COUNT = 6;
var puzzle;
if (DEBUG) {
    //puzzle = PuzzleDemo.random(SLOT_COUNT);
    puzzle = new PuzzleDemo([2, 3, 4, 1, 6, 5]);
    //puzzle = new PuzzleDemo([2, 4, 6, 1, 5, 3]);
    //puzzle = new PuzzleDemo([2, 1, 5, 6, 3, 4]);
    // TODO: try a puzzle where numbers can repeat
}
else {
    puzzle = new HumanPuzzleInterface(SLOT_COUNT);
}
new Solver(puzzle);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWV0aGV1cy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIm1ldGhldXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsOERBQThEO0FBQzlELDhEQUE4RDtBQUU5RCxJQUFNLEtBQUssR0FBRyxJQUFJLENBQUM7QUFFbkI7SUFBQTtJQU9BLENBQUM7SUFOYyxPQUFHLEdBQWpCLFVBQWtCLEdBQVc7UUFDNUIsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksQ0FBSSxHQUFHLE9BQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUMvQyxDQUFDO0lBQ2EsUUFBSSxHQUFsQixVQUFtQixJQUFZO1FBQzlCLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ3pDLENBQUM7SUFDRixVQUFDO0FBQUQsQ0FBQyxBQVBELElBT0M7QUFPRDtJQUdDLG9CQUFtQixRQUFrQjtRQUY3QixhQUFRLEdBQWEsRUFBRSxDQUFDO1FBRy9CLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDO1FBQ3pCLEdBQUcsQ0FBQyxHQUFHLENBQUMsY0FBWSxRQUFRLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBRyxDQUFDLENBQUM7SUFDNUMsQ0FBQztJQUVhLGlCQUFNLEdBQXBCLFVBQXFCLE1BQWM7UUFDbEMsTUFBTSxDQUFDLElBQUksVUFBVSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FDcEMsSUFBSSxLQUFLLENBQUMsTUFBTSxDQUFDLEVBQUUsVUFBVSxDQUFDLEVBQUUsQ0FBQyxJQUFJLE1BQU0sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQzFELENBQUM7SUFFTSxpQ0FBWSxHQUFuQjtRQUNDLE1BQU0sQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FB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Q0FBQztJQUNGLENBQUM7SUFFTSxxQkFBTSxHQUFiO1FBQ0MsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDO1FBQ1gsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLEdBQUcsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUUsQ0FBQyxHQUFHLEdBQUcsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDO1lBQzdELElBQUksSUFBSSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQy9CLElBQUksU0FBUyxHQUFHLENBQUMsSUFBSSxJQUFJLElBQUksQ0FBQyxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxJQUFJLElBQUksQ0FBQyxRQUFRLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDO1lBQzVKLElBQUksSUFBSSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMscUJBQXFCLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDL0MsQ0FBQyxJQUFJLE1BQUcsSUFBSSxHQUFHLEtBQUssR0FBRyxFQUFFLEtBQUcsU0FBUyxHQUFHLEtBQUssR0FBRyxFQUFFLElBQUcsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxJQUFHLFNBQVMsR0FBRyxNQUFNLEdBQUcsRUFBRSxLQUFHLElBQUksR0FBRyxNQUFNLEdBQUcsRUFBRSxPQUFHLENBQUM7UUFDMUksQ0FBQztRQUNELENBQUMsSUFBSSxRQUFNLElBQUksQ0FBQyxPQUFPLFdBQUssSUFBSSxDQUFDLEtBQUssR0FBRyxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssR0FBRyxNQUFJLElB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QUMsQ0FBQztJQUNYLHlDQUF5QztJQUN6QyxNQUFNLEdBQUcsSUFBSSxVQUFVLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDNUMsOENBQThDO0lBQzlDLDhDQUE4QztJQUM5Qyw4Q0FBOEM7QUFDL0MsQ0FBQztBQUNELElBQUksQ0FBQyxDQUFDO0lBQ0wsTUFBTSxHQUFHLElBQUksb0JBQW9CLENBQUMsVUFBVSxDQUFDLENBQUM7QUFDL0MsQ0FBQztBQUNELElBQUksTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIm5vZGVfbW9kdWxlcy9AdHlwZXMvanF1ZXJ5L2luZGV4LmQudHNcIiAvPlxyXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwibm9kZV9tb2R1bGVzL0B0eXBlcy9sb2Rhc2gvaW5kZXguZC50c1wiIC8+XHJcblxyXG5jb25zdCBERUJVRyA9IHRydWU7XHJcblxyXG5jbGFzcyBMb2cge1xyXG5cdHB1YmxpYyBzdGF0aWMgb3V0KG1zZzogc3RyaW5nKSB7XHJcblx0XHQkKFwiPHByZS8+XCIpLnRleHQoYCR7bXNnfVxcbmApLmFwcGVuZFRvKFwiI2xvZ1wiKTtcclxuXHR9XHJcblx0cHVibGljIHN0YXRpYyBodG1sKGh0bWw6IHN0cmluZykge1xyXG5cdFx0JChcIjxkaXYvPlwiKS5odG1sKGh0bWwpLmFwcGVuZFRvKFwiI2xvZ1wiKTtcclxuXHR9XHJcbn1cclxuXHJcbmludGVyZmFjZSBQdXp6bGUge1xyXG5cdHRlc3QoYm9hcmQ6IEJvYXJkKTogbnVtYmVyO1xyXG5cdGdldFNsb3RDb3VudCgpOiBudW1iZXI7XHJcbn1cclxuXHJcbmNsYXNzIFB1enpsZURlbW8gaW1wbGVtZW50cyBQdXp6bGUge1xyXG5cdHByaXZhdGUgc29sdXRpb246IG51bWJlcltdID0gW107XHJcblxyXG5cdHB1YmxpYyBjb25zdHJ1Y3Rvcihzb2x1dGlvbjogbnVtYmVyW10pIHtcclxuXHRcdHRoaXMuc29sdXRpb24gPSBzb2x1dGlvbjtcclxuXHRcdExvZy5vdXQoYFB1enpsZTpcXG4ke3NvbHV0aW9uLmpvaW4oXCIgIFwiKX1gKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBzdGF0aWMgcmFuZG9tKGxlbmd0aDogbnVtYmVyKTogUHV6emxlIHtcclxuXHRcdHJldHVybiBuZXcgUHV6emxlRGVtbyhfLnNodWZmbGUoXy5tYXAoXHJcblx0XHRcdG5ldyBBcnJheShsZW5ndGgpLCBmdW5jdGlvbiAodiwgaykgeyByZXR1cm4gayArIDE7IH0pKSk7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZ2V0U2xvdENvdW50KCk6IG51bWJlciB7XHJcblx0XHRyZXR1cm4gdGhpcy5zb2x1dGlvbi5sZW5ndGg7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgdGVzdChib2FyZDogQm9hcmQpOiBudW1iZXIge1xyXG5cdFx0bGV0IGNvdW50ID0gMDtcclxuXHRcdGZvciAobGV0IGkgPSAwLCBsZW4gPSB0aGlzLnNvbHV0aW9uLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcblx0XHRcdGxldCBjb3JyZWN0ID0gYm9hcmQuc2xvdHNbaV0ucXVhbnRpdHkgPT0gdGhpcy5zb2x1dGlvbltpXTtcclxuXHRcdFx0aWYgKGNvcnJlY3QpIGNvdW50Kys7XHJcblx0XHRcdGlmIChERUJVRykgYm9hcmQuZGVidWdWaWV3Q29ycmVjdFNsb3RzW2ldID0gY29ycmVjdDtcclxuXHRcdH1cclxuXHRcdHJldHVybiBjb3VudDtcclxuXHR9XHJcbn1cclxuXHJcbmNsYXNzIEh1bWFuUHV6emxlSW50ZXJmYWNlIGltcGxlbWVudHMgUHV6emxlIHtcclxuXHRwcml2YXRlIHNsb3RDb3VudDogbnVtYmVyO1xyXG5cclxuXHRwdWJsaWMgY29uc3RydWN0b3Ioc2xvdENvdW50OiBudW1iZXIpIHtcclxuXHRcdHRoaXMuc2xvdENvdW50O1xyXG5cdH1cclxuXHJcblx0cHVibGljIGdldFNsb3RDb3VudCgpOiBudW1iZXIge1xyXG5cdFx0cmV0dXJuIHRoaXMuc2xvdENvdW50O1xyXG5cdH1cclxuXHJcblx0cHVibGljIHRlc3QoYm9hcmQ6IEJvYXJkKTogbnVtYmVyIHtcclxuXHRcdGxldCBhbnN3ZXI7XHJcblx0XHRkbyB7XHJcblx0XHRcdGFuc3dlciA9IHBhcnNlSW50KHByb21wdChcclxuXHRcdFx0XHRgUGxlYXNlIHRyeTpcXG5cXHQke2JvYXJkfVxcblxcbkhvdyBtYW55IGFyZSBjb3JyZWN0P2ApLCAxMCk7XHJcblx0XHR9XHJcblx0XHR3aGlsZSAoIWlzTmFOKGFuc3dlcikpO1xyXG5cdFx0cmV0dXJuIGFuc3dlcjtcclxuXHR9XHJcbn1cclxuXHJcbnR5cGUgRGVkdWN0aW9uID0gXCJVTktOT1dOXCIgfCBcIk5PXCIgfCBcIk1BWUJFXCIgfCBcIllFU1wiO1xyXG5jb25zdCBVTktOT1dOID0gXCJVTktOT1dOXCI7XHJcbmNvbnN0IE5PID0gXCJOT1wiO1xyXG5jb25zdCBNQVlCRSA9IFwiTUFZQkVcIjtcclxuY29uc3QgWUVTID0gXCJZRVNcIjtcclxuXHJcbmNsYXNzIFN3YXAge1xyXG5cdHB1YmxpYyBhOiBudW1iZXI7XHJcblx0cHVibGljIGI6IG51bWJlcjtcclxuXHJcblx0cHVibGljIGNvbnN0cnVjdG9yKGE6IG51bWJlciwgYjogbnVtYmVyKSB7XHJcblx0XHR0aGlzLmEgPSBhO1xyXG5cdFx0dGhpcy5iID0gYjtcclxuXHR9XHJcbn1cclxuXHJcbmNsYXNzIE1vdmUge1xyXG5cdHB1YmxpYyBudW06IG51bWJlcjtcclxuXHRwdWJsaWMgYm9hcmQ6IEJvYXJkO1xyXG5cdHB1YmxpYyBjb3JyZWN0OiBudW1iZXI7IC8vIHNjb3JlXHJcblx0cHVibGljIGRlbHRhOiBudW1iZXI7IC8vIHNjb3JlXHJcblx0cHVibGljIHByZXY/OiBNb3ZlOyAvLyBwbGF5IHNlcXVlbmNlXHJcblx0cHVibGljIHN3YXA/OiBTd2FwO1xyXG5cdHByaXZhdGUgbGVmdDogTW92ZTsgLy8gYnN0XHJcblx0cHJpdmF0ZSByaWdodDogTW92ZTsgLy8gYnN0XHJcblxyXG5cdC8vIG5ldyBtb3ZlIGJhc2VkIG9uIGNvcHkgb2YgZ2l2ZW4gYm9hcmRcclxuXHRwdWJsaWMgY29uc3RydWN0b3IoYm9hcmQ6IEJvYXJkLCBzd2FwPzogU3dhcCkge1xyXG5cdFx0dGhpcy5ib2FyZCA9IF8uY2xvbmVEZWVwKGJvYXJkKTtcclxuXHRcdGlmIChudWxsICE9IHN3YXApIHtcclxuXHRcdFx0bGV0IHRtcCA9IHRoaXMuYm9hcmQuc2xvdHNbc3dhcC5hXTtcclxuXHRcdFx0dGhpcy5ib2FyZC5zbG90c1tzd2FwLmFdID0gdGhpcy5ib2FyZC5zbG90c1tzd2FwLmJdO1xyXG5cdFx0XHR0aGlzLmJvYXJkLnNsb3RzW3N3YXAuYl0gPSB0bXA7XHJcblx0XHRcdHRoaXMuYm9hcmQuc2xvdHNbc3dhcC5hXS5pbmRleCA9IHN3YXAuYTtcclxuXHRcdFx0dGhpcy5ib2FyZC5zbG90c1tzd2FwLmJdLmluZGV4ID0gc3dhcC5iO1xyXG5cdFx0XHR0aGlzLnN3YXAgPSBzd2FwO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0cHVibGljIHJlbmRlcigpIHtcclxuXHRcdGxldCBzID0gXCJcIjtcclxuXHRcdGZvciAobGV0IGkgPSAwLCBsZW4gPSB0aGlzLmJvYXJkLnNsb3RzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcblx0XHRcdGxldCBzbG90ID0gdGhpcy5ib2FyZC5zbG90c1tpXTtcclxuXHRcdFx0bGV0IHVuZGVybGluZSA9IChudWxsICE9IHRoaXMuc3dhcCAmJiAoc2xvdC5xdWFudGl0eSA9PSB0aGlzLmJvYXJkLnNsb3RzW3RoaXMuc3dhcC5hXS5xdWFudGl0eSB8fCBzbG90LnF1YW50aXR5ID09IHRoaXMuYm9hcmQuc2xvdHNbdGhpcy5zd2FwLmJdLnF1YW50aXR5KSk7XHJcblx0XHRcdGxldCBib2xkID0gdGhpcy5ib2FyZC5kZWJ1Z1ZpZXdDb3JyZWN0U2xvdHNbaV07XHJcblx0XHRcdHMgKz0gYCR7Ym9sZCA/IFwiPGI+XCIgOiBcIlwifSR7dW5kZXJsaW5lID8gXCI8dT5cIiA6IFwiXCJ9JHtzbG90LnF1YW50aXR5fSR7c2xvdC5kZWR1Y3Rpb25bMF19JHt1bmRlcmxpbmUgPyBcIjwvdT5cIiA6IFwiXCJ9JHtib2xkID8gXCI8L2I+XCIgOiBcIlwifSBgO1xyXG5cdFx0fVxyXG5cdFx0cyArPSBgID0gJHt0aGlzLmNvcnJlY3R9ICgke3RoaXMuZGVsdGEgPCAwID8gdGhpcy5kZWx0YSA6IGArJHt0aGlzLmRlbHRhfWB9KWA7XHJcblx0XHRMb2cuaHRtbChzKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBzY29yZSgpIHtcclxuXHRcdHJldHVybiB0aGlzLmNvcnJlY3QgKyB0aGlzLmRlbHRhO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHN0YXRpYyByYW5rSW5zZXJ0KHJvb3Q6IE1vdmUsIG1vdmU6IE1vdmUpIHtcclxuXHRcdGxldCBwYXJlbnQ6IE1vdmUgPSBudWxsO1xyXG5cdFx0bGV0IGN1cnJlbnQgPSBtb3ZlO1xyXG5cdFx0d2hpbGUgKHRydWUpIHtcclxuXHRcdFx0cGFyZW50ID0gY3VycmVudDtcclxuXHRcdFx0aWYgKG1vdmUuc2NvcmUoKSA8IHBhcmVudC5zY29yZSgpKSB7XHJcblx0XHRcdFx0Y3VycmVudCA9IHBhcmVudC5sZWZ0O1xyXG5cdFx0XHRcdGlmIChudWxsID09IGN1cnJlbnQpIHtcclxuXHRcdFx0XHRcdHBhcmVudC5sZWZ0ID0gbW92ZTtcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0Y3VycmVudCA9IHBhcmVudC5yaWdodDtcclxuXHRcdFx0XHRpZiAobnVsbCA9PSBjdXJyZW50KSB7XHJcblx0XHRcdFx0XHRwYXJlbnQucmlnaHQgPSBtb3ZlO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0cHVibGljIHN0YXRpYyBmaW5kTW9zdFZhbHVhYmxlTW92ZShyb290OiBNb3ZlKTogTW92ZSB7XHJcblx0XHRpZiAobnVsbCA9PSByb290KSByZXR1cm4gbnVsbDtcclxuXHRcdGxldCBjdXJyZW50ID0gcm9vdDtcclxuXHRcdGxldCBsYXN0SGlnaFNjb3JlID0gY3VycmVudDtcclxuXHRcdHdoaWxlICh0cnVlKSB7XHJcblx0XHRcdGlmIChjdXJyZW50LnNjb3JlKCkgPiBsYXN0SGlnaFNjb3JlLnNjb3JlKCkpXHJcblx0XHRcdHtcclxuXHRcdFx0XHRjdXJyZW50ID0gY3VycmVudC5sZWZ0O1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2VcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGN1cnJlbnQgPSBjdXJyZW50LnJpZ2h0O1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmIChudWxsID09IGN1cnJlbnQpIHtcclxuXHRcdFx0XHRyZXR1cm4gbGFzdEhpZ2hTY29yZTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxufVxyXG5cclxuY2xhc3MgU2xvdCB7XHJcblx0cHVibGljIGluZGV4OiBudW1iZXI7XHJcblx0cHVibGljIHF1YW50aXR5OiBudW1iZXI7XHJcblx0cHVibGljIGRlZHVjdGlvbjogRGVkdWN0aW9uO1xyXG5cclxuXHRwdWJsaWMgc2V0RGVkdWN0aW9uKGRlZHVjdGlvbjogRGVkdWN0aW9uKSB7XHJcblx0XHR0aGlzLmRlZHVjdGlvbiA9IGRlZHVjdGlvbjtcclxuXHRcdExvZy5vdXQoYCAgICAgICAgICAke3RoaXMucXVhbnRpdHl9ICR7dGhpcy5kZWR1Y3Rpb25bMF19ID0+ICR7ZGVkdWN0aW9uWzBdfSR7ZGVkdWN0aW9uID09IFlFUyA/IFwiIEZPVU5EXCIgOiBcIlwifWApO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHRvU3RyaW5nKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMucXVhbnRpdHk7XHJcblx0fVxyXG59XHJcblxyXG5cclxuY2xhc3MgQm9hcmQge1xyXG5cdHB1YmxpYyBzbG90czogU2xvdFtdO1xyXG5cdHB1YmxpYyBkZWJ1Z1ZpZXdDb3JyZWN0U2xvdHM6IGJvb2xlYW5bXSA9IFtdO1xyXG5cclxuXHRwdWJsaWMgY29uc3RydWN0b3Ioc2xvdHM6IFNsb3RbXSkge1xyXG5cdFx0dGhpcy5zbG90cyA9IHNsb3RzO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGZpbmRBbGwoZm4pIHtcclxuXHRcdHJldHVybiBfLmZpbHRlcih0aGlzLnNsb3RzLCBmbik7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZmluZE9uZShmbikge1xyXG5cdFx0cmV0dXJuIHRoaXMuZmluZEFsbChmbilbMF07XHJcblx0fVxyXG5cclxuXHQvLyBmaW5kIHRoZSBhZGphY2VudCBwYWlyIGluIGdpdmVuIHR3byBtb3Zlc1xyXG5cdC8vIGFkaiBwYWlyIGluIHR3byBtb3ZlcyA9XHJcblx0Ly8gaWYgbW92ZTEgPSBhLGIgYW5kIG1vdmUyID0gYixjIHRoZW4gYWpjIHBhaXIgPSBhXHJcblx0cHVibGljIHNldERlZHVjdGlvbigpIHtcclxuXHJcblx0fVxyXG5cclxuXHRwdWJsaWMgcmVuZGVyKCkge1xyXG5cdFx0Zm9yIChsZXQgaSA9IDAsIGxlbiA9IHRoaXMuc2xvdHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuXHRcdFx0JChcInRkI2NcIiArIGkpLnRleHQodGhpcy5zbG90c1tpXS5xdWFudGl0eSArIFwiIFwiICsgdGhpcy5zbG90c1tpXS5kZWR1Y3Rpb25bMF0pO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0cHVibGljIHRvU3RyaW5nKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuc2xvdHMuam9pbihcIiBcIik7XHJcblx0fVxyXG59XHJcblxyXG5jbGFzcyBTb2x2ZXIge1xyXG5cdHByaXZhdGUgcHV6emxlOiBQdXp6bGU7XHJcblx0cHJpdmF0ZSBtb3ZlczogbnVtYmVyID0gMDtcclxuXHRwdWJsaWMgcm9vdE1vdmU6IE1vdmU7IC8vIHJvb3QgQlNUIG5vZGVcclxuXHRwdWJsaWMgbGFzdE1vdmU6IE1vdmU7IC8vIGhpc3Rvcnkgb2YgcGxheWVkIG1vdmVzXHJcblxyXG5cdHB1YmxpYyBjb25zdHJ1Y3RvcihwdXp6bGU6IFB1enpsZSkge1xyXG5cdFx0dGhpcy5wdXp6bGUgPSBwdXp6bGU7XHJcblxyXG5cdFx0Ly8gYmVnaW4gd2l0aCBvcGVuaW5nIG1vdmVcclxuXHRcdHRoaXMucm9vdE1vdmUgPSBuZXcgTW92ZShuZXcgQm9hcmQoXy5tYXAoXHJcblx0XHRcdG5ldyBBcnJheSh0aGlzLnB1enpsZS5nZXRTbG90Q291bnQoKSksXHJcblx0XHRcdChuaWwsIGkpID0+IHtcclxuXHRcdFx0XHRsZXQgc2xvdCA9IG5ldyBTbG90KCk7XHJcblx0XHRcdFx0c2xvdC5pbmRleCA9IGk7XHJcblx0XHRcdFx0c2xvdC5xdWFudGl0eSA9IGkgKyAxO1xyXG5cdFx0XHRcdHNsb3QuZGVkdWN0aW9uID0gVU5LTk9XTjtcclxuXHRcdFx0XHRyZXR1cm4gc2xvdDtcclxuXHRcdFx0fSkpKTtcclxuXHRcdHRoaXMucGxheU1vdmUodGhpcy5yb290TW92ZSk7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgcGxheU1vdmUobW92ZTogTW92ZSkge1xyXG5cdFx0Ly8gc2VxdWVuY2UgbW92ZSBpbnRvIHBsYXlcclxuXHRcdG1vdmUubnVtID0gKyt0aGlzLm1vdmVzO1xyXG5cdFx0bW92ZS5wcmV2ID0gdGhpcy5sYXN0TW92ZTtcclxuXHRcdHRoaXMubGFzdE1vdmUgPSBtb3ZlO1xyXG5cclxuXHRcdC8vIHRlc3QgYW5kIHNjb3JlIHRoZSBtb3ZlXHJcblx0XHRpZiAodGhpcy5tb3ZlcyA+IE1BWF9HVUVTU0VTKSB7XHJcblx0XHRcdExvZy5vdXQoXCJUb28gbWFueSBndWVzc2VzOyB3ZSBsb3NlLlwiKTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdGxldCBjb3JyZWN0ID0gdGhpcy5wdXp6bGUudGVzdChtb3ZlLmJvYXJkKTtcclxuXHRcdFx0bGV0IGRlbHRhID0gY29ycmVjdCAtIChudWxsICE9IG1vdmUgPyBtb3ZlLmNvcnJlY3QgfHwgMCA6IDApO1xyXG5cdFx0XHRNb3ZlLnJhbmtJbnNlcnQodGhpcy5yb290TW92ZSwgbW92ZSk7XHJcblx0XHRcdG1vdmUuYm9hcmQucmVuZGVyKCk7XHJcblx0XHRcdG1vdmUuY29ycmVjdCA9IGNvcnJlY3Q7XHJcblx0XHRcdG1vdmUuZGVsdGEgPSBkZWx0YTtcclxuXHRcdFx0bW92ZS5yZW5kZXIoKTtcclxuXHRcdFx0aWYgKGNvcnJlY3QgPT0gdGhpcy5wdXp6bGUuZ2V0U2xvdENvdW50KCkpIHtcclxuXHRcdFx0XHRMb2cub3V0KGBZb3Ugd2luIGluICR7dGhpcy5tb3Zlc30gbW92ZXMuYCk7XHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gZGVjaWRlIHdoYXQgdG8gZG8gbmV4dFxyXG5cclxuXHJcblx0XHRpZiAobnVsbCAhPSBtb3ZlLnN3YXApIHtcclxuXHRcdFx0aWYgKG1vdmUuZGVsdGEgPT0gMCkge1xyXG5cdFx0XHRcdC8vIG5vIGRpZmZlcmVuY2U7IGJvdGggbXVzdCBiZSBOTz9cclxuXHRcdFx0XHRtb3ZlLnN3YXAuYS5zZXREZWR1Y3Rpb24oTk8pO1xyXG5cdFx0XHRcdG1vdmUuc3dhcC5iLnNldERlZHVjdGlvbihOTyk7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSBpZiAobW92ZS5kZWx0YSA9PSAxKSB7XHJcblx0XHRcdFx0Ly8gZGlmZmVyZW5jZTsgb25lIGlzIG5vdyByaWdodCwgYnV0IHdlIGRvbid0IGtub3cgd2hpY2hcclxuXHRcdFx0XHQvLyB1bmxlc3Mgd2UgaGF2ZSBoaXN0b3J5IHRvIG5hcnJvdyBpdCwgdGhlbiB3ZSBoYXZlIHNwZWNpZmljIG1hdGNoXHJcblx0XHRcdFx0bW92ZS5zd2FwLmEuc2V0RGVkdWN0aW9uKE1BWUJFKTtcclxuXHRcdFx0XHRtb3ZlLnN3YXAuYi5zZXREZWR1Y3Rpb24oTUFZQkUpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2UgaWYgKG1vdmUuZGVsdGEgPT0gMikge1xyXG5cdFx0XHRcdC8vIHZlcnkgcG9zaXRpdmUgZGlmZmVyZW5jZTsgYm90aCBhcmUgbm93IHJpZ2h0IGZvciBzdXJlXHJcblx0XHRcdFx0bW92ZS5zd2FwLmEuc2V0RGVkdWN0aW9uKFlFUyk7XHJcblx0XHRcdFx0bW92ZS5zd2FwLmIuc2V0RGVkdWN0aW9uKFlFUyk7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSBpZiAobW92ZS5kZWx0YSA9PSAtMSkge1xyXG5cdFx0XHRcdC8vIGRpZmZlcmVuY2U7IG9uZSB3YXMgcmlnaHQsIGJ1dCB3ZSBkb24ndCBrbm93IHdoaWNoXHJcblx0XHRcdFx0Ly8gc28gZmlyc3Qgc3RlcCBpcyBhbHdheXMgdG8gcHV0IGl0IGJhY2tcclxuXHRcdFx0XHRtb3ZlLnN3YXAuYS5zZXREZWR1Y3Rpb24oTUFZQkUpO1xyXG5cdFx0XHRcdG1vdmUuc3dhcC5iLnNldERlZHVjdGlvbihNQVlCRSk7XHJcblx0XHRcdFx0dGhpcy5yb2xsYmFjaygpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2UgaWYgKG1vdmUuZGVsdGEgPT0gLTIpIHtcclxuXHRcdFx0XHQvLyBkaWZmZXJlbmNlOyBib3RoIHdlcmUgcmlnaHQgZm9yIHN1cmVcclxuXHRcdFx0XHRtb3ZlLnN3YXAuYS5zZXREZWR1Y3Rpb24oWUVTKTtcclxuXHRcdFx0XHRtb3ZlLnN3YXAuYi5zZXREZWR1Y3Rpb24oWUVTKTtcclxuXHRcdFx0XHR0aGlzLnJvbGxiYWNrKCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRzZXRUaW1lb3V0KCgpID0+IHRoaXMucGxheU1vdmUodGhpcy5uZXdNb3ZlKGEsIGIpKSwgR1VFU1NfREVMQVkpO1xyXG5cdH1cclxuXHJcblx0Ly8gZGV0ZXJtaW5lIHdoZXRoZXIgYSBxdWFudGl0eSBoYXMgZXZlciBoYWQgYSBnaXZlbiBkZWR1Y3Rpb24gYXQgYSBzcGVjaWZpYyBpbmRleCBpbiBlbnRpcmUgaGlzdG9yeVxyXG5cdHB1YmxpYyBoYWREZWR1Y3Rpb25BdEluZGV4KHF1YW50aXR5OiBudW1iZXIsIGluZGV4OiBudW1iZXIsIGRlZHVjdGlvbjogRGVkdWN0aW9uKTogYm9vbGVhbiB7XHJcblx0XHR3aGlsZSAobnVsbCAhPSB0aGlzLmxhc3RNb3ZlLnN3YXApIHtcclxuXHRcdFx0bGV0IHBhaXIgPSB0aGlzLmxhc3RNb3ZlLnN3YXA7XHJcblx0XHRcdGlmIChcclxuXHRcdFx0XHQocGFpci5hLnF1YW50aXR5ID09IHF1YW50aXR5ICYmXHJcblx0XHRcdFx0XHRwYWlyLmEuZGVkdWN0aW9uID09IGRlZHVjdGlvbiAmJlxyXG5cdFx0XHRcdFx0cGFpci5hLmluZGV4ID09IGluZGV4KSB8fFxyXG5cdFx0XHRcdChwYWlyLmIucXVhbnRpdHkgPT0gcXVhbnRpdHkgJiZcclxuXHRcdFx0XHRcdHBhaXIuYi5kZWR1Y3Rpb24gPT0gZGVkdWN0aW9uICYmXHJcblx0XHRcdFx0XHRwYWlyLmIuaW5kZXggPT0gaW5kZXgpXHJcblx0XHRcdCkge1xyXG5cdFx0XHRcdExvZy5vdXQoYCR7cXVhbnRpdHl9IGluZGV4ICR7aW5kZXh9IGRlZHVjdGlvbiAke2RlZHVjdGlvblswXX0gaGFwcGVuZWQgYmVmb3JlIGF0IG1vdmUgJHt0aGlzLmxhc3RNb3ZlLm51bX1gKTtcclxuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdFx0fVxyXG5cdFx0XHR0aGlzLmxhc3RNb3ZlID0gdGhpcy5sYXN0TW92ZS5wcmV2O1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIGZhbHNlO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGFscmVhZHlUcmllZChxMTogbnVtYmVyLCBpMTogbnVtYmVyLCBxMjogbnVtYmVyLCBpMjogbnVtYmVyKTogYm9vbGVhbiB7XHJcblx0XHR3aGlsZSAobnVsbCAhPSB0aGlzLmxhc3RNb3ZlLnN3YXApIHtcclxuXHRcdFx0bGV0IHBhaXIgPSB0aGlzLmxhc3RNb3ZlLnN3YXA7XHJcblx0XHRcdGlmIChcclxuXHRcdFx0XHQocGFpci5hLnF1YW50aXR5ID09IHExICYmXHJcblx0XHRcdFx0XHRwYWlyLmEuaW5kZXggPT0gaTEpIHx8XHJcblx0XHRcdFx0KHBhaXIuYi5xdWFudGl0eSA9PSBxMiAmJlxyXG5cdFx0XHRcdFx0cGFpci5iLmluZGV4ID09IGkyKVxyXG5cdFx0XHQpIHtcclxuXHRcdFx0XHRMb2cub3V0KGAke3ExfToke2kxfSwke3EyfToke2kyfSBoYXBwZW5lZCBiZWZvcmUgYXQgbW92ZSAke3RoaXMubGFzdE1vdmUubnVtfWApO1xyXG5cdFx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0XHR9XHJcblx0XHRcdHRoaXMubGFzdE1vdmUgPSB0aGlzLmxhc3RNb3ZlLnByZXY7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gZmFsc2U7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgcm9sbGJhY2soKSB7XHJcblx0XHRMb2cub3V0KFwicm9sbGJhY2tcIik7XHJcblx0XHRsZXQgbW92ZSA9IG5ldyBNb3ZlKHRoaXMubGFzdE1vdmUuYm9hcmQsIHRoaXMubGFzdE1vdmUuc3dhcC5hLmluZGV4LCB0aGlzLmxhc3RNb3ZlLnN3YXAuYi5pbmRleCk7XHJcblx0XHQvLyBhc3N1bWUgcmVzdWx0IGlzIHNhbWUgYXMgYmVmb3JlXHJcblx0XHRtb3ZlLmNvcnJlY3QgPSB0aGlzLmxhc3RNb3ZlLmNvcnJlY3Q7XHJcblx0XHRtb3ZlLmRlbHRhID0gdGhpcy5sYXN0TW92ZS5kZWx0YSAqIC0xOyAvLyBhc3N1bWUgb3Bwb3NpdGVcclxuXHR9XHJcbn1cclxuXHJcblxyXG5jb25zdCBHVUVTU19ERUxBWSA9IDUwOyAvLyBtc1xyXG5jb25zdCBNQVhfR1VFU1NFUyA9IDk5O1xyXG5jb25zdCBTTE9UX0NPVU5UID0gNjtcclxuXHJcbmxldCBwdXp6bGU7XHJcbmlmIChERUJVRykge1xyXG5cdC8vcHV6emxlID0gUHV6emxlRGVtby5yYW5kb20oU0xPVF9DT1VOVCk7XHJcblx0cHV6emxlID0gbmV3IFB1enpsZURlbW8oWzIsIDMsIDQsIDEsIDYsIDVdKTtcclxuXHQvL3B1enpsZSA9IG5ldyBQdXp6bGVEZW1vKFsyLCA0LCA2LCAxLCA1LCAzXSk7XHJcblx0Ly9wdXp6bGUgPSBuZXcgUHV6emxlRGVtbyhbMiwgMSwgNSwgNiwgMywgNF0pO1xyXG5cdC8vIFRPRE86IHRyeSBhIHB1enpsZSB3aGVyZSBudW1iZXJzIGNhbiByZXBlYXRcclxufVxyXG5lbHNlIHtcclxuXHRwdXp6bGUgPSBuZXcgSHVtYW5QdXp6bGVJbnRlcmZhY2UoU0xPVF9DT1VOVCk7XHJcbn1cclxubmV3IFNvbHZlcihwdXp6bGUpOyJdfQ==