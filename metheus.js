/// <reference path="node_modules/@types/jquery/index.d.ts" />
/// <reference path="node_modules/@types/lodash/index.d.ts" />
var DEBUG = false;
var Log = (function () {
    function Log() {
    }
    Log.out = function (msg) {
        $("<pre/>").text(msg + "\n").appendTo("#log");
    };
    Log.html = function (html) {
        $("<div/>").html(html).appendTo("#log");
    };
    return Log;
}());
var PuzzleDemo = (function () {
    function PuzzleDemo(solution) {
        this.solution = [];
        this.solution = solution;
        Log.out("Puzzle:\n" + solution.join("  "));
    }
    PuzzleDemo.random = function (length) {
        return new PuzzleDemo(_.shuffle(_.map(new Array(length), function (v, k) { return k + 1; })));
    };
    PuzzleDemo.prototype.getSlotCount = function () {
        return this.solution.length;
    };
    PuzzleDemo.prototype.test = function (board) {
        var count = 0;
        for (var i = 0, len = this.solution.length; i < len; i++) {
            var correct = board.slots[i].quantity == this.solution[i];
            if (correct)
                count++;
            if (DEBUG)
                board.debugViewCorrectSlots[i] = correct;
        }
        return count;
    };
    return PuzzleDemo;
}());
var HumanPuzzleInterface = (function () {
    function HumanPuzzleInterface(slotCount) {
        this.slotCount = slotCount;
    }
    HumanPuzzleInterface.prototype.getSlotCount = function () {
        return this.slotCount;
    };
    HumanPuzzleInterface.prototype.test = function (board) {
        var answer;
        do {
            answer = parseInt(prompt("Please try:\n\n    " + board + "\n\nHow many are correct?"), 10);
        } while (isNaN(answer));
        return answer;
    };
    return HumanPuzzleInterface;
}());
var UNKNOWN = "UNKNOWN";
var NO = "NO";
var MAYBE = "MAYBE";
var YES = "YES";
var Swap = (function () {
    function Swap(a, b) {
        this.a = a;
        this.b = b;
    }
    return Swap;
}());
var Move = (function () {
    // new move based on copy of given move
    function Move(base, board, swap) {
        this.base = base;
        this.board = _.cloneDeep(board);
        if (null != swap) {
            var tmp = this.board.slots[swap.a];
            this.board.slots[swap.a] = this.board.slots[swap.b];
            this.board.slots[swap.b] = tmp;
            this.board.slots[swap.a].index = swap.a;
            this.board.slots[swap.b].index = swap.b;
            this.swap = swap;
        }
    }
    Move.prototype.render = function () {
        var s = this.num + ": ";
        for (var i = 0, len = this.board.slots.length; i < len; i++) {
            var slot = this.board.slots[i];
            var underline = (null != this.swap && (slot.quantity == this.board.slots[this.swap.a].quantity || slot.quantity == this.board.slots[this.swap.b].quantity));
            var bold = this.board.debugViewCorrectSlots[i];
            s += "" + (bold ? "<b>" : "") + (underline ? "<u>" : "") + slot.quantity + slot.deduction[0] + (underline ? "</u>" : "") + (bold ? "</b>" : "") + " ";
        }
        s += (this.num === 1 ? "FIRST" :
            " = " + this.correct + " (" + (this.delta < 0 ? this.delta : "+" + this.delta) + ") score: " + this.score());
        Log.html(s);
    };
    Move.prototype.score = function () {
        return this.correct + (this.delta * .5);
    };
    Move.prototype.getSwapA = function () {
        return this.board.slots[this.swap.a];
    };
    Move.prototype.getSwapB = function () {
        return this.board.slots[this.swap.b];
    };
    Move.prototype.hasSwapDeduction = function (a, b) {
        return this.getSwapA().deduction == a &&
            this.getSwapB().deduction == b;
    };
    Move.rankInsert = function (root, move) {
        var parent = null;
        var current = root;
        var i = 0;
        while (i++ < LOOP_BREAKER) {
            parent = current;
            if (move.score() < parent.score()) {
                current = parent.left;
                if (null == current) {
                    parent.left = move;
                    return;
                }
            }
            else {
                current = parent.right;
                if (null == current) {
                    parent.right = move;
                    return;
                }
            }
        }
    };
    // TODO: find the adjacent pair in given two moves
    // adj pair in two moves =
    // if move1 = a,b and move2 = b,c then ajc pair = a
    Move.copyMostValuableMove = function (root) {
        if (null == root)
            return null;
        var current = root;
        var mostValuable = current;
        var i = 0;
        while (i++ < LOOP_BREAKER) {
            if (mostValuable.score() < current.score()) {
                mostValuable = current;
            }
            if (current.right && current.score() < current.right.score()) {
                current = current.right;
            }
            else if (current.left && current.score() < current.left.score()) {
                current = current.left;
            }
            else {
                return mostValuable.clone();
            }
        }
    };
    Move.prototype.clone = function () {
        var move = new Move(this, this.board);
        move.num = this.num;
        move.correct = this.correct;
        move.delta = this.delta;
        return move;
    };
    Move.havePlayedBefore = function (last, candidate) {
        var current = last;
        var i = 0;
        while (null != current && i++ < LOOP_BREAKER) {
            if (Board.compare(current.board, candidate.board)) {
                //if (DEBUG) Log.out(`Rejecting board played before at move ${current.num}`);
                return true;
            }
            current = current.prev;
        }
        return false;
    };
    Move.hadDeductionAtIndex = function (last, quantity, index, deduction) {
        var current = last;
        var i = 0;
        while (null != current && i++ < LOOP_BREAKER) {
            if (current.board.slots[index].quantity == quantity &&
                current.board.slots[index].deduction == deduction) {
                //if (DEBUG) Log.out(`Rejecting index deduced ${deduction} before at move ${current.num}`);
                return true;
            }
            current = current.prev;
        }
        return false;
    };
    return Move;
}());
var Slot = (function () {
    function Slot() {
    }
    Slot.prototype.setDeduction = function (deduction) {
        if (DEBUG)
            Log.out("    " + this.quantity + " " + this.deduction[0] + " => " + deduction[0] + (deduction == YES ? " FOUND" : ""));
        this.deduction = deduction;
    };
    Slot.prototype.toString = function () {
        return this.quantity;
    };
    return Slot;
}());
var Board = (function () {
    function Board(slots) {
        this.debugViewCorrectSlots = [];
        this.slots = slots;
    }
    Board.prototype.findAll = function (fn) {
        return _.filter(this.slots, fn);
    };
    Board.prototype.findOne = function (fn) {
        return this.findAll(fn)[0];
    };
    Board.compare = function (a, b) {
        if (a.slots.length != b.slots.length)
            return false;
        for (var i = 0, len = a.slots.length; i < len; i++) {
            if (a.slots[i].quantity != b.slots[i].quantity) {
                return false;
            }
        }
        return true;
    };
    Board.prototype.render = function () {
        for (var i = 0, len = this.slots.length; i < len; i++) {
            $("td#c" + i).text(this.slots[i].quantity + " " + this.slots[i].deduction[0]);
        }
    };
    Board.prototype.toString = function () {
        return this.slots.join(" ");
    };
    return Board;
}());
var Solver = (function () {
    function Solver(puzzle) {
        this.moves = 0;
        this.puzzle = puzzle;
        // begin with opening move
        this.rootMove = new Move(null, new Board(_.map(new Array(this.puzzle.getSlotCount()), function (nil, i) {
            var slot = new Slot();
            slot.index = i;
            slot.quantity = i + 1;
            slot.deduction = UNKNOWN;
            return slot;
        })));
        this.playMove(this.rootMove);
    }
    Solver.prototype.playMove = function (move) {
        // sequence move into play
        move.num = ++this.moves;
        move.prev = this.lastMove;
        this.lastMove = move;
        // test and score the move
        debugger;
        move.correct = this.puzzle.test(move.board);
        move.delta = move.correct - (null != move.base ? move.base.correct || 0 : 0);
        if (this.moves > MAX_GUESSES) {
            Log.out("Too many guesses; we lose.");
            return;
        }
        if (null != move.swap) {
            // apply swap deductions
            if (move.delta == 0) {
                // no difference; both must be NO
                move.getSwapA().setDeduction(NO);
                move.getSwapB().setDeduction(NO);
            }
            else if (move.delta == 1) {
                // difference; one is now right, but we don't know which
                move.getSwapA().setDeduction(MAYBE);
                move.getSwapB().setDeduction(MAYBE);
            }
            else if (move.delta == 2) {
                // very positive difference; both are now right for sure
                move.getSwapA().setDeduction(YES);
                move.getSwapB().setDeduction(YES);
            }
            else if (move.delta == -1) {
                // difference; one was right, but we don't know which
                move.getSwapA().setDeduction(MAYBE);
                move.getSwapB().setDeduction(MAYBE);
            }
            else if (move.delta == -2) {
                // difference; both were right for sure
                move.getSwapA().setDeduction(YES);
                move.getSwapB().setDeduction(YES);
            }
        }
        if (this.rootMove != move) {
            Move.rankInsert(this.rootMove, move);
        }
        // update user view
        move.board.render();
        move.render();
        if (move.correct == this.puzzle.getSlotCount()) {
            Log.out("You win in " + this.moves + " moves.");
            return;
        }
        this.decide();
    };
    Solver.prototype.decide = function () {
        var _this = this;
        // decide what to do next
        var nextMove;
        if (1 === this.moves) {
            // just play a swap of the first two positions
            nextMove = new Move(this.lastMove, this.lastMove.board, new Swap(0, 1));
        }
        else {
            var move = Move.copyMostValuableMove(this.rootMove);
            // try a unique new swap from non-yes deductions
            var tries = 0;
            do {
                //				// if the previous swap was M,M or N,N
                //				if (
                //					(move.hasSwapDeduction(MAYBE, MAYBE) ||
                //						move.hasSwapDeduction(NO, NO))
                //				) {
                //					// it should reuse A from the previous move
                //					// unless that resulted in a no change or unexpected gain
                //					// in which case it should now reuse B from two moves ago
                //				}
                //				else {
                //					// rotate through untested swaps remaining
                //
                //				}
                nextMove = new Move(move, move.board, new Swap(Math.floor(Math.random() * move.board.slots.length), Math.floor(Math.random() * move.board.slots.length)));
            } while ((Move.havePlayedBefore(this.lastMove, nextMove) ||
                YES == nextMove.getSwapA().deduction ||
                YES == nextMove.getSwapB().deduction ||
                Move.hadDeductionAtIndex(this.lastMove, nextMove.getSwapA().quantity, nextMove.getSwapA().index, NO) ||
                Move.hadDeductionAtIndex(this.lastMove, nextMove.getSwapB().quantity, nextMove.getSwapB().index, NO)) && tries++ < 100);
        }
        if (null == nextMove) {
            Log.out("Unable to find next move.");
            return;
        }
        setTimeout(function () { return _this.playMove(nextMove); }, GUESS_DELAY);
    };
    return Solver;
}());
var LOOP_BREAKER = 999;
var GUESS_DELAY = 50; // ms
var MAX_GUESSES = 20;
var SLOT_COUNT = 6;
var puzzle;
if (DEBUG) {
    puzzle = PuzzleDemo.random(SLOT_COUNT);
    //puzzle = new PuzzleDemo([2, 3, 4, 1, 6, 5]);
    //puzzle = new PuzzleDemo([2, 4, 6, 1, 5, 3]);
    //puzzle = new PuzzleDemo([2, 1, 5, 6, 3, 4]);
    // TODO: try a puzzle where numbers can repeat
}
else {
    puzzle = new HumanPuzzleInterface(SLOT_COUNT);
}
new Solver(puzzle);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWV0aGV1cy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIm1ldGhldXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsOERBQThEO0FBQzlELDhEQUE4RDtBQUU5RCxJQUFNLEtBQUssR0FBRyxLQUFLLENBQUM7QUFFcEI7SUFBQTtJQU9BLENBQUM7SUFOYyxPQUFHLEdBQWpCLFVBQWtCLEdBQVc7UUFDNUIsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksQ0FBSSxHQUFHLE9BQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUMvQyxDQUFDO0lBQ2EsUUFBSSxHQUFsQixVQUFtQixJQUFZO1FBQzlCLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ3pDLENBQUM7SUFDRixVQUFDO0FBQUQsQ0FBQyxBQVBELElBT0M7QUFPRDtJQUdDLG9CQUFtQixRQUFrQjtRQUY3QixhQUFRLEdBQWEsRUFBRSxDQUFDO1FBRy9CLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDO1FBQ3pCLEdBQUcsQ0FBQyxHQUFHLENBQUMsY0FBWSxRQUFRLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBRyxDQUFDLENBQUM7SUFDNUMsQ0FBQztJQUVhLGlCQUFNLEdBQXBCLFVBQXFCLE1BQWM7UUFDbEMsTUFBTSxDQUFDLElBQUksVUFBVSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FDcEMsSUFBSSxLQUFLLENBQUMsTUFBTSxDQUFDLEVBQUUsVUFBVSxDQUFDLEVBQUUsQ0FBQyxJQUFJLE1BQU0sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQzFELENBQUM7SUFFTSxpQ0FBWSxHQUFuQjtRQUNDLE1BQU0sQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FB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Y0FBTSxPQUFBLEtBQUksQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLEVBQXZCLENBQXVCLEVBQUUsV0FBVyxDQUFDLENBQUM7SUFDeEQsQ0FBQztJQUNGLGFBQUM7QUFBRCxDQUFDLEFBL0hELElBK0hDO0FBRUQsSUFBTSxZQUFZLEdBQUcsR0FBRyxDQUFDO0FBQ3pCLElBQU0sV0FBVyxHQUFHLEVBQUUsQ0FBQyxDQUFDLEtBQUs7QUFDN0IsSUFBTSxXQUFXLEdBQUcsRUFBRSxDQUFDO0FBQ3ZCLElBQU0sVUFBVSxHQUFHLENBQUMsQ0FBQztBQUVyQixJQUFJLE1BQU0sQ0FBQztBQUNYLEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7SUFDWCxNQUFNLEdBQUcsVUFBVSxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUN2Qyw4Q0FBOEM7SUFDOUMsOENBQThDO0lBQzlDLDhDQUE4QztJQUM5Qyw4Q0FBOEM7QUFDL0MsQ0FBQztBQUNELElBQUksQ0FBQyxDQUFDO0lBQ0wsTUFBTSxHQUFHLElBQUksb0JBQW9CLENBQUMsVUFBVSxDQUFDLENBQUM7QUFDL0MsQ0FBQztBQUNELElBQUksTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIm5vZGVfbW9kdWxlcy9AdHlwZXMvanF1ZXJ5L2luZGV4LmQudHNcIiAvPlxyXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwibm9kZV9tb2R1bGVzL0B0eXBlcy9sb2Rhc2gvaW5kZXguZC50c1wiIC8+XHJcblxyXG5jb25zdCBERUJVRyA9IGZhbHNlO1xyXG5cclxuY2xhc3MgTG9nIHtcclxuXHRwdWJsaWMgc3RhdGljIG91dChtc2c6IHN0cmluZykge1xyXG5cdFx0JChcIjxwcmUvPlwiKS50ZXh0KGAke21zZ31cXG5gKS5hcHBlbmRUbyhcIiNsb2dcIik7XHJcblx0fVxyXG5cdHB1YmxpYyBzdGF0aWMgaHRtbChodG1sOiBzdHJpbmcpIHtcclxuXHRcdCQoXCI8ZGl2Lz5cIikuaHRtbChodG1sKS5hcHBlbmRUbyhcIiNsb2dcIik7XHJcblx0fVxyXG59XHJcblxyXG5pbnRlcmZhY2UgUHV6emxlIHtcclxuXHR0ZXN0KGJvYXJkOiBCb2FyZCk6IG51bWJlcjtcclxuXHRnZXRTbG90Q291bnQoKTogbnVtYmVyO1xyXG59XHJcblxyXG5jbGFzcyBQdXp6bGVEZW1vIGltcGxlbWVudHMgUHV6emxlIHtcclxuXHRwcml2YXRlIHNvbHV0aW9uOiBudW1iZXJbXSA9IFtdO1xyXG5cclxuXHRwdWJsaWMgY29uc3RydWN0b3Ioc29sdXRpb246IG51bWJlcltdKSB7XHJcblx0XHR0aGlzLnNvbHV0aW9uID0gc29sdXRpb247XHJcblx0XHRMb2cub3V0KGBQdXp6bGU6XFxuJHtzb2x1dGlvbi5qb2luKFwiICBcIil9YCk7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc3RhdGljIHJhbmRvbShsZW5ndGg6IG51bWJlcik6IFB1enpsZSB7XHJcblx0XHRyZXR1cm4gbmV3IFB1enpsZURlbW8oXy5zaHVmZmxlKF8ubWFwKFxyXG5cdFx0XHRuZXcgQXJyYXkobGVuZ3RoKSwgZnVuY3Rpb24gKHYsIGspIHsgcmV0dXJuIGsgKyAxOyB9KSkpO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGdldFNsb3RDb3VudCgpOiBudW1iZXIge1xyXG5cdFx0cmV0dXJuIHRoaXMuc29sdXRpb24ubGVuZ3RoO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHRlc3QoYm9hcmQ6IEJvYXJkKTogbnVtYmVyIHtcclxuXHRcdGxldCBjb3VudCA9IDA7XHJcblx0XHRmb3IgKGxldCBpID0gMCwgbGVuID0gdGhpcy5zb2x1dGlvbi5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG5cdFx0XHRsZXQgY29ycmVjdCA9IGJvYXJkLnNsb3RzW2ldLnF1YW50aXR5ID09IHRoaXMuc29sdXRpb25baV07XHJcblx0XHRcdGlmIChjb3JyZWN0KSBjb3VudCsrO1xyXG5cdFx0XHRpZiAoREVCVUcpIGJvYXJkLmRlYnVnVmlld0NvcnJlY3RTbG90c1tpXSA9IGNvcnJlY3Q7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gY291bnQ7XHJcblx0fVxyXG59XHJcblxyXG5jbGFzcyBIdW1hblB1enpsZUludGVyZmFjZSBpbXBsZW1lbnRzIFB1enpsZSB7XHJcblx0cHJpdmF0ZSBzbG90Q291bnQ6IG51bWJlcjtcclxuXHJcblx0cHVibGljIGNvbnN0cnVjdG9yKHNsb3RDb3VudDogbnVtYmVyKSB7XHJcblx0XHR0aGlzLnNsb3RDb3VudCA9IHNsb3RDb3VudDtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXRTbG90Q291bnQoKTogbnVtYmVyIHtcclxuXHRcdHJldHVybiB0aGlzLnNsb3RDb3VudDtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyB0ZXN0KGJvYXJkOiBCb2FyZCk6IG51bWJlciB7XHJcblx0XHRsZXQgYW5zd2VyO1xyXG5cdFx0ZG8ge1xyXG5cdFx0XHRhbnN3ZXIgPSBwYXJzZUludChwcm9tcHQoXHJcblx0XHRcdFx0YFBsZWFzZSB0cnk6XFxuXFxuICAgICR7Ym9hcmR9XFxuXFxuSG93IG1hbnkgYXJlIGNvcnJlY3Q/YCksIDEwKTtcclxuXHRcdH1cclxuXHRcdHdoaWxlIChpc05hTihhbnN3ZXIpKTtcclxuXHRcdHJldHVybiBhbnN3ZXI7XHJcblx0fVxyXG59XHJcblxyXG50eXBlIERlZHVjdGlvbiA9IFwiVU5LTk9XTlwiIHwgXCJOT1wiIHwgXCJNQVlCRVwiIHwgXCJZRVNcIjtcclxuY29uc3QgVU5LTk9XTiA9IFwiVU5LTk9XTlwiO1xyXG5jb25zdCBOTyA9IFwiTk9cIjtcclxuY29uc3QgTUFZQkUgPSBcIk1BWUJFXCI7XHJcbmNvbnN0IFlFUyA9IFwiWUVTXCI7XHJcblxyXG5jbGFzcyBTd2FwIHtcclxuXHRwdWJsaWMgYTogbnVtYmVyO1xyXG5cdHB1YmxpYyBiOiBudW1iZXI7XHJcblxyXG5cdHB1YmxpYyBjb25zdHJ1Y3RvcihhOiBudW1iZXIsIGI6IG51bWJlcikge1xyXG5cdFx0dGhpcy5hID0gYTtcclxuXHRcdHRoaXMuYiA9IGI7XHJcblx0fVxyXG59XHJcblxyXG5jbGFzcyBNb3ZlIHtcclxuXHRwdWJsaWMgbnVtOiBudW1iZXI7XHJcblx0cHVibGljIGJvYXJkOiBCb2FyZDtcclxuXHRwdWJsaWMgY29ycmVjdDogbnVtYmVyOyAvLyBzY29yZVxyXG5cdHB1YmxpYyBkZWx0YTogbnVtYmVyOyAvLyBzY29yZVxyXG5cdHB1YmxpYyBwcmV2PzogTW92ZTsgLy8gcGxheSBzZXF1ZW5jZVxyXG5cdHB1YmxpYyBiYXNlOiBNb3ZlOyAvLyBjb3BpZWQgZnJvbVxyXG5cdHB1YmxpYyBzd2FwPzogU3dhcDtcclxuXHRwcml2YXRlIGxlZnQ6IE1vdmU7IC8vIGJzdFxyXG5cdHByaXZhdGUgcmlnaHQ6IE1vdmU7IC8vIGJzdFxyXG5cclxuXHQvLyBuZXcgbW92ZSBiYXNlZCBvbiBjb3B5IG9mIGdpdmVuIG1vdmVcclxuXHRwdWJsaWMgY29uc3RydWN0b3IoYmFzZTogTW92ZSwgYm9hcmQ6IEJvYXJkLCBzd2FwPzogU3dhcCkge1xyXG5cdFx0dGhpcy5iYXNlID0gYmFzZTtcclxuXHRcdHRoaXMuYm9hcmQgPSBfLmNsb25lRGVlcChib2FyZCk7XHJcblx0XHRpZiAobnVsbCAhPSBzd2FwKSB7XHJcblx0XHRcdGxldCB0bXAgPSB0aGlzLmJvYXJkLnNsb3RzW3N3YXAuYV07XHJcblx0XHRcdHRoaXMuYm9hcmQuc2xvdHNbc3dhcC5hXSA9IHRoaXMuYm9hcmQuc2xvdHNbc3dhcC5iXTtcclxuXHRcdFx0dGhpcy5ib2FyZC5zbG90c1tzd2FwLmJdID0gdG1wO1xyXG5cdFx0XHR0aGlzLmJvYXJkLnNsb3RzW3N3YXAuYV0uaW5kZXggPSBzd2FwLmE7XHJcblx0XHRcdHRoaXMuYm9hcmQuc2xvdHNbc3dhcC5iXS5pbmRleCA9IHN3YXAuYjtcclxuXHRcdFx0dGhpcy5zd2FwID0gc3dhcDtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHB1YmxpYyByZW5kZXIoKSB7XHJcblx0XHRsZXQgcyA9IGAke3RoaXMubnVtfTogYDtcclxuXHRcdGZvciAobGV0IGkgPSAwLCBsZW4gPSB0aGlzLmJvYXJkLnNsb3RzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcblx0XHRcdGxldCBzbG90ID0gdGhpcy5ib2FyZC5zbG90c1tpXTtcclxuXHRcdFx0bGV0IHVuZGVybGluZSA9IChudWxsICE9IHRoaXMuc3dhcCAmJiAoc2xvdC5xdWFudGl0eSA9PSB0aGlzLmJvYXJkLnNsb3RzW3RoaXMuc3dhcC5hXS5xdWFudGl0eSB8fCBzbG90LnF1YW50aXR5ID09IHRoaXMuYm9hcmQuc2xvdHNbdGhpcy5zd2FwLmJdLnF1YW50aXR5KSk7XHJcblx0XHRcdGxldCBib2xkID0gdGhpcy5ib2FyZC5kZWJ1Z1ZpZXdDb3JyZWN0U2xvdHNbaV07XHJcblx0XHRcdHMgKz0gYCR7Ym9sZCA/IFwiPGI+XCIgOiBcIlwifSR7dW5kZXJsaW5lID8gXCI8dT5cIiA6IFwiXCJ9JHtzbG90LnF1YW50aXR5fSR7c2xvdC5kZWR1Y3Rpb25bMF19JHt1bmRlcmxpbmUgPyBcIjwvdT5cIiA6IFwiXCJ9JHtib2xkID8gXCI8L2I+XCIgOiBcIlwifSBgO1xyXG5cdFx0fVxyXG5cdFx0cyArPSAodGhpcy5udW0gPT09IDEgPyBcIkZJUlNUXCIgOlxyXG5cdFx0XHRgID0gJHt0aGlzLmNvcnJlY3R9ICgke3RoaXMuZGVsdGEgPCAwID8gdGhpcy5kZWx0YSA6IGArJHt0aGlzLmRlbHRhfWB9KSBzY29yZTogJHt0aGlzLnNjb3JlKCl9YCk7XHJcblx0XHRMb2cuaHRtbChzKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBzY29yZSgpIHtcclxuXHRcdHJldHVybiB0aGlzLmNvcnJlY3QgKyAodGhpcy5kZWx0YSAqIC41KVxyXG5cdH1cclxuXHJcblx0cHVibGljIGdldFN3YXBBKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuYm9hcmQuc2xvdHNbdGhpcy5zd2FwLmFdO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGdldFN3YXBCKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuYm9hcmQuc2xvdHNbdGhpcy5zd2FwLmJdO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGhhc1N3YXBEZWR1Y3Rpb24oYTogRGVkdWN0aW9uLCBiOiBEZWR1Y3Rpb24pIHtcclxuXHRcdHJldHVybiB0aGlzLmdldFN3YXBBKCkuZGVkdWN0aW9uID09IGEgJiZcclxuXHRcdFx0dGhpcy5nZXRTd2FwQigpLmRlZHVjdGlvbiA9PSBiO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHN0YXRpYyByYW5rSW5zZXJ0KHJvb3Q6IE1vdmUsIG1vdmU6IE1vdmUpIHtcclxuXHRcdGxldCBwYXJlbnQ6IE1vdmUgPSBudWxsO1xyXG5cdFx0bGV0IGN1cnJlbnQgPSByb290O1xyXG5cdFx0bGV0IGkgPSAwO1xyXG5cdFx0d2hpbGUgKGkrKyA8IExPT1BfQlJFQUtFUikge1xyXG5cdFx0XHRwYXJlbnQgPSBjdXJyZW50O1xyXG5cdFx0XHRpZiAobW92ZS5zY29yZSgpIDwgcGFyZW50LnNjb3JlKCkpIHtcclxuXHRcdFx0XHRjdXJyZW50ID0gcGFyZW50LmxlZnQ7XHJcblx0XHRcdFx0aWYgKG51bGwgPT0gY3VycmVudCkge1xyXG5cdFx0XHRcdFx0cGFyZW50LmxlZnQgPSBtb3ZlO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRjdXJyZW50ID0gcGFyZW50LnJpZ2h0O1xyXG5cdFx0XHRcdGlmIChudWxsID09IGN1cnJlbnQpIHtcclxuXHRcdFx0XHRcdHBhcmVudC5yaWdodCA9IG1vdmU7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvLyBUT0RPOiBmaW5kIHRoZSBhZGphY2VudCBwYWlyIGluIGdpdmVuIHR3byBtb3Zlc1xyXG5cdC8vIGFkaiBwYWlyIGluIHR3byBtb3ZlcyA9XHJcblx0Ly8gaWYgbW92ZTEgPSBhLGIgYW5kIG1vdmUyID0gYixjIHRoZW4gYWpjIHBhaXIgPSBhXHJcblxyXG5cdHB1YmxpYyBzdGF0aWMgY29weU1vc3RWYWx1YWJsZU1vdmUocm9vdDogTW92ZSk6IE1vdmUge1xyXG5cdFx0aWYgKG51bGwgPT0gcm9vdCkgcmV0dXJuIG51bGw7XHJcblx0XHRsZXQgY3VycmVudCA9IHJvb3Q7XHJcblx0XHRsZXQgbW9zdFZhbHVhYmxlID0gY3VycmVudDtcclxuXHRcdGxldCBpID0gMDtcclxuXHRcdHdoaWxlIChpKysgPCBMT09QX0JSRUFLRVIpIHtcclxuXHRcdFx0aWYgKG1vc3RWYWx1YWJsZS5zY29yZSgpIDwgY3VycmVudC5zY29yZSgpKSB7XHJcblx0XHRcdFx0bW9zdFZhbHVhYmxlID0gY3VycmVudDtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoY3VycmVudC5yaWdodCAmJiBjdXJyZW50LnNjb3JlKCkgPCBjdXJyZW50LnJpZ2h0LnNjb3JlKCkpIHtcclxuXHRcdFx0XHRjdXJyZW50ID0gY3VycmVudC5yaWdodDtcclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlIGlmIChjdXJyZW50LmxlZnQgJiYgY3VycmVudC5zY29yZSgpIDwgY3VycmVudC5sZWZ0LnNjb3JlKCkpIHtcclxuXHRcdFx0XHRjdXJyZW50ID0gY3VycmVudC5sZWZ0O1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdHJldHVybiBtb3N0VmFsdWFibGUuY2xvbmUoKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0cHVibGljIGNsb25lKCk6IE1vdmUge1xyXG5cdFx0bGV0IG1vdmUgPSBuZXcgTW92ZSh0aGlzLCB0aGlzLmJvYXJkKTtcclxuXHRcdG1vdmUubnVtID0gdGhpcy5udW07XHJcblx0XHRtb3ZlLmNvcnJlY3QgPSB0aGlzLmNvcnJlY3Q7XHJcblx0XHRtb3ZlLmRlbHRhID0gdGhpcy5kZWx0YTtcclxuXHRcdHJldHVybiBtb3ZlO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHN0YXRpYyBoYXZlUGxheWVkQmVmb3JlKGxhc3Q6IE1vdmUsIGNhbmRpZGF0ZTogTW92ZSk6IGJvb2xlYW4ge1xyXG5cdFx0bGV0IGN1cnJlbnQgPSBsYXN0O1xyXG5cdFx0bGV0IGkgPSAwO1xyXG5cdFx0d2hpbGUgKG51bGwgIT0gY3VycmVudCAmJiBpKysgPCBMT09QX0JSRUFLRVIpIHtcclxuXHRcdFx0aWYgKEJvYXJkLmNvbXBhcmUoY3VycmVudC5ib2FyZCwgY2FuZGlkYXRlLmJvYXJkKSkge1xyXG5cdFx0XHRcdC8vaWYgKERFQlVHKSBMb2cub3V0KGBSZWplY3RpbmcgYm9hcmQgcGxheWVkIGJlZm9yZSBhdCBtb3ZlICR7Y3VycmVudC5udW19YCk7XHJcblx0XHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHRcdH1cclxuXHRcdFx0Y3VycmVudCA9IGN1cnJlbnQucHJldjtcclxuXHRcdH1cclxuXHRcdHJldHVybiBmYWxzZTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBzdGF0aWMgaGFkRGVkdWN0aW9uQXRJbmRleChsYXN0OiBNb3ZlLCBxdWFudGl0eTogbnVtYmVyLCBpbmRleDogbnVtYmVyLCBkZWR1Y3Rpb246IERlZHVjdGlvbik6IGJvb2xlYW4ge1xyXG5cdFx0bGV0IGN1cnJlbnQgPSBsYXN0O1xyXG5cdFx0bGV0IGkgPSAwO1xyXG5cdFx0d2hpbGUgKG51bGwgIT0gY3VycmVudCAmJiBpKysgPCBMT09QX0JSRUFLRVIpIHtcclxuXHRcdFx0aWYgKGN1cnJlbnQuYm9hcmQuc2xvdHNbaW5kZXhdLnF1YW50aXR5ID09IHF1YW50aXR5ICYmXHJcblx0XHRcdFx0Y3VycmVudC5ib2FyZC5zbG90c1tpbmRleF0uZGVkdWN0aW9uID09IGRlZHVjdGlvblxyXG5cdFx0XHQpIHtcclxuXHRcdFx0XHQvL2lmIChERUJVRykgTG9nLm91dChgUmVqZWN0aW5nIGluZGV4IGRlZHVjZWQgJHtkZWR1Y3Rpb259IGJlZm9yZSBhdCBtb3ZlICR7Y3VycmVudC5udW19YCk7XHJcblx0XHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHRcdH1cclxuXHRcdFx0Y3VycmVudCA9IGN1cnJlbnQucHJldjtcclxuXHRcdH1cclxuXHRcdHJldHVybiBmYWxzZTtcclxuXHR9XHJcbn1cclxuXHJcbmNsYXNzIFNsb3Qge1xyXG5cdHB1YmxpYyBpbmRleDogbnVtYmVyO1xyXG5cdHB1YmxpYyBxdWFudGl0eTogbnVtYmVyO1xyXG5cdHB1YmxpYyBkZWR1Y3Rpb246IERlZHVjdGlvbjtcclxuXHJcblx0cHVibGljIHNldERlZHVjdGlvbihkZWR1Y3Rpb246IERlZHVjdGlvbikge1xyXG5cdFx0aWYgKERFQlVHKSBMb2cub3V0KGAgICAgJHt0aGlzLnF1YW50aXR5fSAke3RoaXMuZGVkdWN0aW9uWzBdfSA9PiAke2RlZHVjdGlvblswXX0ke2RlZHVjdGlvbiA9PSBZRVMgPyBcIiBGT1VORFwiIDogXCJcIn1gKTtcclxuXHRcdHRoaXMuZGVkdWN0aW9uID0gZGVkdWN0aW9uO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHRvU3RyaW5nKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMucXVhbnRpdHk7XHJcblx0fVxyXG59XHJcblxyXG5cclxuY2xhc3MgQm9hcmQge1xyXG5cdHB1YmxpYyBzbG90czogU2xvdFtdO1xyXG5cdHB1YmxpYyBkZWJ1Z1ZpZXdDb3JyZWN0U2xvdHM6IGJvb2xlYW5bXSA9IFtdO1xyXG5cclxuXHRwdWJsaWMgY29uc3RydWN0b3Ioc2xvdHM6IFNsb3RbXSkge1xyXG5cdFx0dGhpcy5zbG90cyA9IHNsb3RzO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGZpbmRBbGwoZm4pIHtcclxuXHRcdHJldHVybiBfLmZpbHRlcih0aGlzLnNsb3RzLCBmbik7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZmluZE9uZShmbikge1xyXG5cdFx0cmV0dXJuIHRoaXMuZmluZEFsbChmbilbMF07XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc3RhdGljIGNvbXBhcmUoYTogQm9hcmQsIGI6IEJvYXJkKSB7XHJcblx0XHRpZiAoYS5zbG90cy5sZW5ndGggIT0gYi5zbG90cy5sZW5ndGgpIHJldHVybiBmYWxzZTtcclxuXHRcdGZvciAobGV0IGkgPSAwLCBsZW4gPSBhLnNsb3RzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcblx0XHRcdGlmIChhLnNsb3RzW2ldLnF1YW50aXR5ICE9IGIuc2xvdHNbaV0ucXVhbnRpdHkpIHtcclxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHJldHVybiB0cnVlO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHJlbmRlcigpIHtcclxuXHRcdGZvciAobGV0IGkgPSAwLCBsZW4gPSB0aGlzLnNsb3RzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcblx0XHRcdCQoXCJ0ZCNjXCIgKyBpKS50ZXh0KHRoaXMuc2xvdHNbaV0ucXVhbnRpdHkgKyBcIiBcIiArIHRoaXMuc2xvdHNbaV0uZGVkdWN0aW9uWzBdKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHB1YmxpYyB0b1N0cmluZygpIHtcclxuXHRcdHJldHVybiB0aGlzLnNsb3RzLmpvaW4oXCIgXCIpO1xyXG5cdH1cclxufVxyXG5cclxuY2xhc3MgU29sdmVyIHtcclxuXHRwcml2YXRlIHB1enpsZTogUHV6emxlO1xyXG5cdHByaXZhdGUgbW92ZXM6IG51bWJlciA9IDA7XHJcblx0cHVibGljIHJvb3RNb3ZlOiBNb3ZlOyAvLyByb290IEJTVCBub2RlXHJcblx0cHVibGljIGxhc3RNb3ZlOiBNb3ZlOyAvLyBoaXN0b3J5IG9mIHBsYXllZCBtb3Zlc1xyXG5cdHB1YmxpYyBzb2x1dGlvbjogbnVtYmVyW107XHJcblxyXG5cdHB1YmxpYyBjb25zdHJ1Y3RvcihwdXp6bGU6IFB1enpsZSkge1xyXG5cdFx0dGhpcy5wdXp6bGUgPSBwdXp6bGU7XHJcblxyXG5cdFx0Ly8gYmVnaW4gd2l0aCBvcGVuaW5nIG1vdmVcclxuXHRcdHRoaXMucm9vdE1vdmUgPSBuZXcgTW92ZShudWxsLCBuZXcgQm9hcmQoXy5tYXAoXHJcblx0XHRcdG5ldyBBcnJheSh0aGlzLnB1enpsZS5nZXRTbG90Q291bnQoKSksXHJcblx0XHRcdChuaWwsIGkpID0+IHtcclxuXHRcdFx0XHRsZXQgc2xvdCA9IG5ldyBTbG90KCk7XHJcblx0XHRcdFx0c2xvdC5pbmRleCA9IGk7XHJcblx0XHRcdFx0c2xvdC5xdWFudGl0eSA9IGkgKyAxO1xyXG5cdFx0XHRcdHNsb3QuZGVkdWN0aW9uID0gVU5LTk9XTjtcclxuXHRcdFx0XHRyZXR1cm4gc2xvdDtcclxuXHRcdFx0fSkpKTtcclxuXHRcdHRoaXMucGxheU1vdmUodGhpcy5yb290TW92ZSk7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgcGxheU1vdmUobW92ZTogTW92ZSkge1xyXG5cdFx0Ly8gc2VxdWVuY2UgbW92ZSBpbnRvIHBsYXlcclxuXHRcdG1vdmUubnVtID0gKyt0aGlzLm1vdmVzO1xyXG5cdFx0bW92ZS5wcmV2ID0gdGhpcy5sYXN0TW92ZTtcclxuXHRcdHRoaXMubGFzdE1vdmUgPSBtb3ZlO1xyXG5cclxuXHRcdC8vIHRlc3QgYW5kIHNjb3JlIHRoZSBtb3ZlXHJcblx0XHRkZWJ1Z2dlcjtcclxuXHRcdG1vdmUuY29ycmVjdCA9IHRoaXMucHV6emxlLnRlc3QobW92ZS5ib2FyZCk7XHJcblx0XHRtb3ZlLmRlbHRhID0gbW92ZS5jb3JyZWN0IC0gKG51bGwgIT0gbW92ZS5iYXNlID8gbW92ZS5iYXNlLmNvcnJlY3QgfHwgMCA6IDApO1xyXG5cdFx0aWYgKHRoaXMubW92ZXMgPiBNQVhfR1VFU1NFUykge1xyXG5cdFx0XHRMb2cub3V0KFwiVG9vIG1hbnkgZ3Vlc3Nlczsgd2UgbG9zZS5cIik7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHRcdGlmIChudWxsICE9IG1vdmUuc3dhcCkge1xyXG5cdFx0XHQvLyBhcHBseSBzd2FwIGRlZHVjdGlvbnNcclxuXHRcdFx0aWYgKG1vdmUuZGVsdGEgPT0gMCkge1xyXG5cdFx0XHRcdC8vIG5vIGRpZmZlcmVuY2U7IGJvdGggbXVzdCBiZSBOT1xyXG5cdFx0XHRcdG1vdmUuZ2V0U3dhcEEoKS5zZXREZWR1Y3Rpb24oTk8pO1xyXG5cdFx0XHRcdG1vdmUuZ2V0U3dhcEIoKS5zZXREZWR1Y3Rpb24oTk8pO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2UgaWYgKG1vdmUuZGVsdGEgPT0gMSkge1xyXG5cdFx0XHRcdC8vIGRpZmZlcmVuY2U7IG9uZSBpcyBub3cgcmlnaHQsIGJ1dCB3ZSBkb24ndCBrbm93IHdoaWNoXHJcblx0XHRcdFx0bW92ZS5nZXRTd2FwQSgpLnNldERlZHVjdGlvbihNQVlCRSk7XHJcblx0XHRcdFx0bW92ZS5nZXRTd2FwQigpLnNldERlZHVjdGlvbihNQVlCRSk7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSBpZiAobW92ZS5kZWx0YSA9PSAyKSB7XHJcblx0XHRcdFx0Ly8gdmVyeSBwb3NpdGl2ZSBkaWZmZXJlbmNlOyBib3RoIGFyZSBub3cgcmlnaHQgZm9yIHN1cmVcclxuXHRcdFx0XHRtb3ZlLmdldFN3YXBBKCkuc2V0RGVkdWN0aW9uKFlFUyk7XHJcblx0XHRcdFx0bW92ZS5nZXRTd2FwQigpLnNldERlZHVjdGlvbihZRVMpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2UgaWYgKG1vdmUuZGVsdGEgPT0gLTEpIHtcclxuXHRcdFx0XHQvLyBkaWZmZXJlbmNlOyBvbmUgd2FzIHJpZ2h0LCBidXQgd2UgZG9uJ3Qga25vdyB3aGljaFxyXG5cdFx0XHRcdG1vdmUuZ2V0U3dhcEEoKS5zZXREZWR1Y3Rpb24oTUFZQkUpO1xyXG5cdFx0XHRcdG1vdmUuZ2V0U3dhcEIoKS5zZXREZWR1Y3Rpb24oTUFZQkUpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2UgaWYgKG1vdmUuZGVsdGEgPT0gLTIpIHtcclxuXHRcdFx0XHQvLyBkaWZmZXJlbmNlOyBib3RoIHdlcmUgcmlnaHQgZm9yIHN1cmVcclxuXHRcdFx0XHRtb3ZlLmdldFN3YXBBKCkuc2V0RGVkdWN0aW9uKFlFUyk7XHJcblx0XHRcdFx0bW92ZS5nZXRTd2FwQigpLnNldERlZHVjdGlvbihZRVMpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRpZiAodGhpcy5yb290TW92ZSAhPSBtb3ZlKSB7XHJcblx0XHRcdE1vdmUucmFua0luc2VydCh0aGlzLnJvb3RNb3ZlLCBtb3ZlKTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyB1cGRhdGUgdXNlciB2aWV3XHJcblx0XHRtb3ZlLmJvYXJkLnJlbmRlcigpO1xyXG5cdFx0bW92ZS5yZW5kZXIoKTtcclxuXHRcdGlmIChtb3ZlLmNvcnJlY3QgPT0gdGhpcy5wdXp6bGUuZ2V0U2xvdENvdW50KCkpIHtcclxuXHRcdFx0TG9nLm91dChgWW91IHdpbiBpbiAke3RoaXMubW92ZXN9IG1vdmVzLmApO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5kZWNpZGUoKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBkZWNpZGUoKSB7XHJcblx0XHQvLyBkZWNpZGUgd2hhdCB0byBkbyBuZXh0XHJcblx0XHRsZXQgbmV4dE1vdmU6IE1vdmU7XHJcblx0XHRpZiAoMSA9PT0gdGhpcy5tb3ZlcykgeyAvLyBmb2xsb3ctdXAgdG8gZmlyc3QgbW92ZVxyXG5cdFx0XHQvLyBqdXN0IHBsYXkgYSBzd2FwIG9mIHRoZSBmaXJzdCB0d28gcG9zaXRpb25zXHJcblx0XHRcdG5leHRNb3ZlID0gbmV3IE1vdmUodGhpcy5sYXN0TW92ZSwgdGhpcy5sYXN0TW92ZS5ib2FyZCwgbmV3IFN3YXAoMCwgMSkpO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7IC8vIHN1YnNlcXVlbnQgbW92ZXNcclxuXHRcdFx0bGV0IG1vdmUgPSBNb3ZlLmNvcHlNb3N0VmFsdWFibGVNb3ZlKHRoaXMucm9vdE1vdmUpO1xyXG5cdFx0XHQvLyB0cnkgYSB1bmlxdWUgbmV3IHN3YXAgZnJvbSBub24teWVzIGRlZHVjdGlvbnNcclxuXHRcdFx0bGV0IHRyaWVzID0gMDtcclxuXHRcdFx0ZG8ge1xyXG5cdFx0XHRcdC8vXHRcdFx0XHQvLyBpZiB0aGUgcHJldmlvdXMgc3dhcCB3YXMgTSxNIG9yIE4sTlxyXG5cdFx0XHRcdC8vXHRcdFx0XHRpZiAoXHJcblx0XHRcdFx0Ly9cdFx0XHRcdFx0KG1vdmUuaGFzU3dhcERlZHVjdGlvbihNQVlCRSwgTUFZQkUpIHx8XHJcblx0XHRcdFx0Ly9cdFx0XHRcdFx0XHRtb3ZlLmhhc1N3YXBEZWR1Y3Rpb24oTk8sIE5PKSlcclxuXHRcdFx0XHQvL1x0XHRcdFx0KSB7XHJcblx0XHRcdFx0Ly9cdFx0XHRcdFx0Ly8gaXQgc2hvdWxkIHJldXNlIEEgZnJvbSB0aGUgcHJldmlvdXMgbW92ZVxyXG5cdFx0XHRcdC8vXHRcdFx0XHRcdC8vIHVubGVzcyB0aGF0IHJlc3VsdGVkIGluIGEgbm8gY2hhbmdlIG9yIHVuZXhwZWN0ZWQgZ2FpblxyXG5cdFx0XHRcdC8vXHRcdFx0XHRcdC8vIGluIHdoaWNoIGNhc2UgaXQgc2hvdWxkIG5vdyByZXVzZSBCIGZyb20gdHdvIG1vdmVzIGFnb1xyXG5cdFx0XHRcdC8vXHRcdFx0XHR9XHJcblx0XHRcdFx0Ly9cdFx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdC8vXHRcdFx0XHRcdC8vIHJvdGF0ZSB0aHJvdWdoIHVudGVzdGVkIHN3YXBzIHJlbWFpbmluZ1xyXG5cdFx0XHRcdC8vXHJcblx0XHRcdFx0Ly9cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0bmV4dE1vdmUgPSBuZXcgTW92ZShtb3ZlLCBtb3ZlLmJvYXJkLCBuZXcgU3dhcChcclxuXHRcdFx0XHRcdE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIG1vdmUuYm9hcmQuc2xvdHMubGVuZ3RoKSxcclxuXHRcdFx0XHRcdE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIG1vdmUuYm9hcmQuc2xvdHMubGVuZ3RoKVxyXG5cdFx0XHRcdCkpO1xyXG5cdFx0XHR9XHJcblx0XHRcdC8vIFRPRE86IGZpeCB0aGlzOyBpdHMgcmV0cnlpbmcgcHJldmlvdXMgY29tYm9zXHJcblx0XHRcdHdoaWxlIChcclxuXHRcdFx0XHQoTW92ZS5oYXZlUGxheWVkQmVmb3JlKHRoaXMubGFzdE1vdmUsIG5leHRNb3ZlKSB8fFxyXG5cdFx0XHRcdFx0WUVTID09IG5leHRNb3ZlLmdldFN3YXBBKCkuZGVkdWN0aW9uIHx8XHJcblx0XHRcdFx0XHRZRVMgPT0gbmV4dE1vdmUuZ2V0U3dhcEIoKS5kZWR1Y3Rpb24gfHxcclxuXHRcdFx0XHRcdE1vdmUuaGFkRGVkdWN0aW9uQXRJbmRleCh0aGlzLmxhc3RNb3ZlLCBuZXh0TW92ZS5nZXRTd2FwQSgpLnF1YW50aXR5LCBuZXh0TW92ZS5nZXRTd2FwQSgpLmluZGV4LCBOTykgfHxcclxuXHRcdFx0XHRcdE1vdmUuaGFkRGVkdWN0aW9uQXRJbmRleCh0aGlzLmxhc3RNb3ZlLCBuZXh0TW92ZS5nZXRTd2FwQigpLnF1YW50aXR5LCBuZXh0TW92ZS5nZXRTd2FwQigpLmluZGV4LCBOTylcclxuXHRcdFx0XHQpICYmIHRyaWVzKysgPCAxMDApO1xyXG5cdFx0fVxyXG5cdFx0aWYgKG51bGwgPT0gbmV4dE1vdmUpIHtcclxuXHRcdFx0TG9nLm91dChcIlVuYWJsZSB0byBmaW5kIG5leHQgbW92ZS5cIik7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHRzZXRUaW1lb3V0KCgpID0+IHRoaXMucGxheU1vdmUobmV4dE1vdmUpLCBHVUVTU19ERUxBWSk7XHJcblx0fVxyXG59XHJcblxyXG5jb25zdCBMT09QX0JSRUFLRVIgPSA5OTk7XHJcbmNvbnN0IEdVRVNTX0RFTEFZID0gNTA7IC8vIG1zXHJcbmNvbnN0IE1BWF9HVUVTU0VTID0gMjA7XHJcbmNvbnN0IFNMT1RfQ09VTlQgPSA2O1xyXG5cclxubGV0IHB1enpsZTtcclxuaWYgKERFQlVHKSB7XHJcblx0cHV6emxlID0gUHV6emxlRGVtby5yYW5kb20oU0xPVF9DT1VOVCk7XHJcblx0Ly9wdXp6bGUgPSBuZXcgUHV6emxlRGVtbyhbMiwgMywgNCwgMSwgNiwgNV0pO1xyXG5cdC8vcHV6emxlID0gbmV3IFB1enpsZURlbW8oWzIsIDQsIDYsIDEsIDUsIDNdKTtcclxuXHQvL3B1enpsZSA9IG5ldyBQdXp6bGVEZW1vKFsyLCAxLCA1LCA2LCAzLCA0XSk7XHJcblx0Ly8gVE9ETzogdHJ5IGEgcHV6emxlIHdoZXJlIG51bWJlcnMgY2FuIHJlcGVhdFxyXG59XHJcbmVsc2Uge1xyXG5cdHB1enpsZSA9IG5ldyBIdW1hblB1enpsZUludGVyZmFjZShTTE9UX0NPVU5UKTtcclxufVxyXG5uZXcgU29sdmVyKHB1enpsZSk7Il19